openapi: 3.0.3
servers:
  - description: Localhost on port 8080
    url: http://localhost:8080
  - description: OSDM Mock on Mocklab
    url: http://osdm.mocklab.io
  - description: OEBB OSDM Simulator
    url: https://tickets-otest.oebb.at/osdm-sim/api
info:
  title: UIC 90918-10 - OSDM
  version: 1.3.0-rc1
  description: |
    Specifications for the OSDM API standard. The OSDM specification supports two
    modes of operation: Distributor Mode and Allocator Mode. The API works the same in 
    both mode, except that in allocator mode the API also returns fare information.
    The OSDM specification combines the allocator and distributor modes into one aligned
    API interface.
  contact:
    name: Nicolas Selleslagh, Clemens Gantert and Andreas Schlapbach
    url: https://unioninternationalcheminsdefer.github.io/OSDM/
    email: osdm@uic.org
  license:
    name: Apache 2.0
    url: 'https://www.apache.org/licenses/LICENSE-2.0.html'
tags:
  - name: Place Information
    description: >-
      resources to search for place information
  - name: Trips
    description: >-
      resources to search for trips
  - name: Offers
    description: >-
      resources to get bookable offers
  - name: Bookings
    description: >-
      resources to manipulate bookings
  - name: Fares
    description: >-
      resources to access fares
  - name: Reservations
    description: >-
      resources to access reservations
  - name: Passengers
    description: >-
      resources to manipulate a passenger's information at every stage of the flow
  - name: Products
    description: >-
      resources to retrieve products information on one or more products
  - name: Fulfillments
    description: >-
      resources to retrieve fulfillments, e.g. tickets
  - name: Refund
    description: >-
      resources to get and accept a refund offer
  - name: Exchange
    description: >-
      resources to get exchange offers and book it
  - name: CoachLayouts
    description: >-
      resources to get the layout of a coach
paths:
  /place-informations:
    post:
      tags:
        - Place Information
      summary: returns trips for a given place information request
      description: >-
        Returns place information for a given place information request based on the OJP specification.
      operationId: postPlaceInformations
      parameters:
        - $ref: "#/components/parameters/acceptLanguage"
        - $ref: "#/components/parameters/accessToken"
      requestBody:
        description: request for place information
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PlaceInformationRequest"
      responses:
        "200":
          description: place information found matching criteria
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PlaceInformationResponse"
        "400":
          description: bad input parameter
        "401":
          description: unauthorized
        "403":
          description: forbidden
        "404":
          description: no place information found
        "500":
          $ref: '#/components/responses/InternalServerErrorResponse'
        "501":
          description: not implemented
        "503":
          description: service unavailable

  /place-informations/{placeInformationId}:
    get:
      tags: 
        - Place Information
      summary: return place-informations
      description: >-
        Returns trips for a given trip request based on the specification.
      operationId: getPlaceInformations
      parameters:
        - $ref: "#/components/parameters/acceptLanguage"
        - $ref: "#/components/parameters/accessToken"
        - in: path
          name: placeInformationId
          schema:
            type: string
          required: true
          description: ID of the place information to get.
      responses:
        "200":
          description: place information found matching criteria
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PlaceInformationResponse"
        "400":
          description: bad input parameter
        "401":
          description: unauthorized
        "403":
          description: forbidden
        "404":
          description: no place information found
        "500":
          $ref: '#/components/responses/InternalServerErrorResponse'
        "501":
          description: not implemented
        "503":
          description: service unavailable

  /trips/{tripId}:
    get:
      tags:
        - Trips
      summary: Returns a trip element representing a travel trip.
      description:
        A trip consists of one or more segments for a given tripId. Depending on the 
        embed either references or full location definitions is returned.
      operationId: getTripsId
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage"
        - in: path
          name: tripId
          schema:
            type: string
            description: unique (on this server) and opaque id of the trip
          required: true
          description: ID of the trip to get.
        - in: query
          name: embed
          description: >-
            Influences whether referenced resources are returned in full or as references only. 
          schema:
            type: array
            items:
              type: string
              enum:
                - ALL
                - NONE
            default: [ALL]
      responses:
        '200':
          description: the requested trip
          headers:
            Cache-Control:
              schema:
                type: string
                default: 'public, max-age=10000'
                description: >-
                  A trip resource is fairly persistent and has a medium time to live to allow short-term caching.
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
                  trip:
                    $ref: '#/components/schemas/Trip'
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented

  /trips:
    post:
      tags:
        - Trips
      summary: returns trips for a given OJP trip request
      description: >-
        Returns trips for a given trip request based on the OJP specification.
      operationId: postTrips
      parameters:
        - $ref: "#/components/parameters/acceptLanguage"
        - $ref: "#/components/parameters/accessToken"
      requestBody:
        description: request for trips
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/TripRequest"
      responses:
        "200":
          description: trips found matching criteria
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TripResponse"
        "400":
          description: bad input parameter
        "401":
          description: unauthorized
        "403":
          description: forbidden
        "404":
          description: no trips found
        "500":
          description: internal server error
          content:
            "application/problem+json":
              schema:
                $ref: "#/components/schemas/Problem"
        "501":
          description: not implemented
        "503":
          description: service unavailable

  /trips-collection/{tripsCollectionId}:
    get:
      tags:
        - Trips
      summary: Returns a collection of trips for a specified origin and destination (and via).
      description: >-
        The unique codes of the origin and
        destination can be resolved using the locations service.
      operationId: getTripsCollectionId
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage"
        - in: path
          name: tripsCollectionId
          schema:
            type: string
          required: true
          description: ID of the trip to get.
        - name: scrollContext
          in: query
          description: >-
            Based on a previous search-response, earlier or later connections
            for the same trip can be retrieved by scrolling back and forth (by
            a pointer-context). You must use the same request parameters as in
            the original trips-request and the given values in the response for
            either "scrollBackContext" or "scrollForwardContext" for optional
            scrolling.
          schema:
            type: string
          required: false
        - in: query
          name: embed
          description: >-
            Influences whether referenced resources are returned in full or as references only. 
          schema:
            type: array
            items:
              type: string
              enum:
                - ALL
                - TRIPS
                - TRIPS.LOCATIONS
                - NONE
            default: [ALL]
      responses:
        '200':
          description: Trip(s) found   
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
                  id:
                    type: string
                    format: uuid
                  tripsCollection:
                    type: array
                    items:
                      $ref: '#/components/schemas/Trip'
                  scrollBackContext:
                    type: string
                    description: >-
                      Scroll reference for the current response to scroll backward. 
                      (Value depends on underlying system.)
                  scrollForwardContext:
                    type: string
                    description: >-
                      Scroll reference for the current response to scroll forward.
                      (Value depends on underlying system.)
                  links:
                    type: array
                    items:
                      $ref: '#/components/schemas/Link'
                required:
                  - id
                  - tripsCollection
          headers:
            Content-Language:
              schema:
                type: string
                description: >-
                  The language of translatable strings in the response (see RFC2616-sec14.12).
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented

  /trip-offers-collection/{tripOffersCollectionId}:
    get:
      tags:
        - Offers
      summary: Returns different offers and trips for a specified origin and destination (and via). 
      description:
        The unique codes of the origin and destination can be resolved using the locations service.
      operationId: getTripOffersCollectionId
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage"
        - in: path
          name: tripOffersCollectionId
          schema:
            type: string
          required: true
          description: ID of the trip to get.
        - name: scrollContext
          in: query
          description: >-
            Based on a previous search-response, earlier or later connections
            for the same trip can be retrieved by scrolling back and forth (by
            a pointer-context). You must use the same request parameters as in
            the original trips-request and the given values in the response for
            either "ScrollBack-Context" or "ScrollForward-Context" for optional
            scrolling.
          schema:
            type: string
          required: false                
        - in: query
          name: embed
          description: >-
            Influences whether referenced resources are returned in full or as references only. 
          schema:
            type: array
            items:
              type: string
              enum:
                - ALL
                - TRIPOFFERS
                - TRIPOFFERS.TRIPS
                - TRIPOFFERS.TRIPS.LOCATIONS
                - TRIPOFFERS.OFFERS
                - TRIPOFFERS.OFFERS.OFFERPARTS
                - TRIPOFFERS.PASSENGERS
                - NONE
            default: [ALL]
      responses:
        '200':
          description: Trip Offer Collection(s) found
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                     $ref: '#/components/schemas/WarningMessageList'
                  id:
                    type: string
                    format: uuid
                  tripOffers:
                    type: array
                    items:
                      $ref: '#/components/schemas/TripOffer'
                  scrollBackContext:
                    type: string
                    description: >-
                      Scroll reference for the current response to scroll backward. (Value
                      depends on underlying system.)
                  scrollForwardContext:
                    type: string
                    description: >-
                      Scroll reference for the current response to scroll forward.
                      (Value depends on underlying system.)
                  links:
                    type: array
                    items:
                      $ref: '#/components/schemas/Link'
                required:
                  - id
                  - tripOffers
          headers:
            Content-Language:
              schema:
                type: string
                description: >-
                  The language of translatable strings in the response (see RFC2616-sec14.12).
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented
          
  /trip-offers-collection:
    post:
      tags:
        - Offers
      summary: Returns trip offers for origin and destination (and via) locations. 
      operationId: postTripOffersCollection
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage"
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TripOfferRequest'
      responses:
        '200':
          description: Collection of trip offers found
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
                  id:
                    type: string
                    format: uuid
                  tripOffers:
                    type: array
                    items:
                      $ref: '#/components/schemas/TripOffer'
                  scrollBackContext:
                    type: string
                    description: >-
                      Scroll reference for the current response to scroll backward. (Value
                      depends on underlying system.)
                  scrollForwardContext:
                    type: string
                    description: >-
                      Scroll reference for the current response to scroll forward.
                      (Value depends on underlying system.)
                  links:
                    type: array
                    items:
                      $ref: '#/components/schemas/Link'
                required:
                  - id
                  - tripOffers
          headers:
            Content-Language:
              schema:
                type: string
                description: >-
                  The language of translatable strings in the response (see RFC2616-sec14.12).
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '409':
          $ref: '#/components/responses/ConflictResponse'
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented

  /trip-offers/{tripOfferId}:
    get:
      tags:
        - Offers
      summary: Returns different offers for a specified tripOfferId.
      operationId: getTripOffersId
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage"
        - in: path
          name: tripOfferId
          schema:
            type: string
          required: true
          description: ID of the trip to get.
        - in: query
          name: embed
          description: >-
            Influences whether referenced resources are returned in full or as references only. 
          schema:
            type: array
            items:
              type: string
              enum:
                - ALL              
                - TRIPS
                - TRIPS.LOCATIONS
                - OFFERS
                - OFFERS.OFFERPARTS
                - PASSENGERS
                - NONE
            default: [ALL]
      responses:
        '200':
          description: Trip offer found
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
                  tripOffer:
                    $ref: '#/components/schemas/TripOffer'
          headers:
            Content-Language:
              schema:
                type: string
                description: >-
                  The language of translatable strings in the response (see RFC2616-sec14.12).
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented
   
  /offers/{offerId}:
    get:
      tags:
        - Offers
      summary: Returns an offer for the id requested.
      operationId: getOffersId
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage"
        - in: path
          name: offerId
          schema:
            type: string
            format: uuid
          required: true
          description: ID of the trip to get.
        - in: query
          name: embed
          description: >-
            Influences whether referenced resources are returned in full or as references only.
          schema:
            type: array
            items:
              type: string
              enum:
                - ALL
                - OFFERPARTS
                - TRIP
                - TRIP.LOCATIONS
                - NONE
            default: [ALL]
      responses:
        '200':
          description: Offer found
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
                  offer:
                    description: >-
                      Either an Offer or a NonTripOffer is returned.
                    oneOf:
                      - $ref: '#/components/schemas/Offer'
                      - $ref: '#/components/schemas/NonTripOffer'
          headers:
            Content-Language:
              schema:
                type: string
                description: >-
                  The language of translatable strings in the response (see RFC2616-sec14.12).
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented

  /non-trip-offers-collection:
    post:
      tags:
        - Offers 
      summary: Returns offers for non-journey based products.
      description: >- 
        Get offers based on key words or regional information not linked to trips. 
        This includes simple passes or one day tickets. 
      operationId: offerCollections
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage"
      requestBody:
        description: request parameter for offer search
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NonTripOfferSearch'
      responses:
        '200':
          description: offer collection
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
                  id:
                    type: string
                    format: uuid
                  nonTripOffers:
                    type: array
                    items:
                      $ref: '#/components/schemas/NonTripOffer'
                  links:
                    type: array
                    items:
                      $ref: '#/components/schemas/Link'
                required:
                  - id
                  - nonTripOffers
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '409':
          $ref: '#/components/responses/ConflictResponse'
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented
  
  '/offers/{offerId}/reservations/{reservationId}/available-preferences':             
    get:
      tags:
        - Reservations
      summary: Allows validating reservation selection parameters.
      description: >-
        The selected place preferences of the customer are checked for availability and the in combination available preferences are returned.
        This service provides the availability service to be compliant with existing 90918-1 services (as-if-reservation).
      operationId: validateReservationPreferencesId
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage"
        - in: path
          name: offerId
          schema:
            type: string
          required: true
          description: ID of the offer.
        - in: path
          name: reservationId
          schema:
            type: string
          required: true
          description: ID of the reservation where to validate the place availability
        - in: query
          name: preferences
          description: >-
            Place preferences (see code list PLacePreferences) the customer wants to have 
          schema:
            type: array
            items:
              type: string
        - in: query
          name: preferenceBundles
          description: >-
            Place preferences the customer wants to have applying to a selection of passengers or transportables only
          schema:
            type: array
            items:
              type: object
              properties:
                passengerId:
                  type: string
                preferences:
                 description: >-
                    Place preferences (see code list PlacePreferences) the customer wants to have 
                 type: array
                 items:
                   type: string
      responses:
        '200':
          description: places available
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
                  reservation:
                    $ref: '#/components/schemas/AvailablePlacePreferences'
          headers:
            Content-Language:
              schema:
                type: string
                description: >-
                  The language of translatable strings in the response (see RFC2616-sec14.12).
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented          
          
  '/offers/{offerId}/reservations/{reservationId}/nearby':             
    get:
      tags:
        - Reservations
      summary: >-
        Allows validating reservation selection parameters near to a reference place.
      description: >-
        Check whether the reservation can be located near the provided reference place
        If selected place preferences of the customer are provided they are checked for availability and the in 
        combination available preferences are returned. This service provides the availability service to be 
        compliant with existing 90918-1 services (as-if-reservation).
      operationId: validateReservationNearbyId
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage"
        - in: path
          name: offerId
          schema:
            type: string
          required: true
          description: ID of the offer.
        - in: path
          name: reservationId
          schema:
            type: string
          required: true
          description: ID of the reservation where to validate the place availability
        - in: query
          name: coachNumber
          description: coach of the referenced place
          schema:
            type: string
          required: true
        - in: query
          name: placeNumber
          description: place number of the referenced place
          schema:
            type: string
          required: true          
        - in: query
          name: preferences
          description: >-
            Place preferences (see code list Reservation Preferences) the customer wants to have 
          schema:
            type: array
            items:
              type: string
        - in: query
          name: preferenceBundles
          description: >-
            Place preferences the customer wants to have applying to a selection of passengers or transportables only
          schema:
            type: array
            items:
              type: object
              properties:
                passengerId:
                  type: string
                preferences:
                 description: >-
                    Place preferences (see code list Reservation Preferences) the customer wants to have 
                 type: array
                 items:
                   type: string
      responses:
        '200':
          description: nearby places available
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
                  reservation:
                    $ref: '#/components/schemas/AvailablePlacePreferences'
          headers:
            Content-Language:
              schema:
                type: string
                description: >-
                  The language of translatable strings in the response (see RFC2616-sec14.12).
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented                
          
  '/offers/{offerId}/reservations/{reservationId}/place-map':             
    get:
      tags:
        - Reservations
      summary: Provides available places for place selection.
      description: >-
        Provide the availability per place to be displayed in a graphical place map for place selection.
        If selected place preferences of the customer are provided they are checked for availability and the in 
        combination available preferences are returned.
      operationId: provideReservationSeatMap
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage"
        - in: path
          name: offerId
          schema:
            type: string
          required: true
          description: ID of the offer.
        - in: path
          name: reservationId
          schema:
            type: string
          required: true
          description: ID of the reservation where to validate the place availability
        - in: query
          name: preferences
          description: >-
            Place preferences (see code list PLacePreferences) the customer wants to have 
          schema:
            type: array
            items:
              type: string
        - in: query
          name: preferenceBundles
          description: >-
            Place preferences the customer wants to have applying to a selection of passengers or transportables only
          schema:
            type: array
            items:
              type: object
              properties:
                passengerId:
                  type: string
                preferences:
                 description: >-
                    Place preferences (see code list PlacePreferences) the customer wants to have 
                 type: array
                 items:
                   type: string
      responses:
        '200':
          description: available places for selection
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
                  reservation:
                    $ref: '#/components/schemas/PlaceAvailability'
          headers:
            Content-Language:
              schema:
                type: string
                description: >-
                  The language of translatable strings in the response (see RFC2616-sec14.12).
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented                 
          
  '/offers/{offerId}/fares/{fareId}/available-preferences':             
    get:
      tags:
        - Fares
      summary: Allows validating reservation selection parameters.
      description: >-
        The selected place preferences of the customer are checked for availability and the in combination
        available preferences are returned. This service provides the availability service to be compliant 
        with existing 90918-1 services (as-if-reservation)
      operationId: validateFareReservationPreferencesId
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage"
        - in: path
          name: offerId
          schema:
            type: string
          required: true
          description: ID of the offer.
        - in: path
          name: fareId
          schema:
            type: string
          required: true
          description: ID of the fare where to validate the place availability
        - in: query
          name: preferences
          description: >-
            Place preferences (see code list PLacePreferences) the customer wants to have 
          schema:
            type: array
            items:
              type: string
        - in: query
          name: preferenceBundles
          description: >-
            Place preferences the customer wants to have applying to a selection of passengers or transportables only
          schema:
            type: array
            items:
              type: object
              properties:
                passengerId:
                  type: string
                preferences:
                 description: >-
                    Place preferences (see code list PlacePreferences) the customer wants to have 
                 type: array
                 items:
                   type: string
      responses:
        '200':
          description: Places available
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
                  reservation:
                    $ref: '#/components/schemas/AvailablePlacePreferences'
          headers:
            Content-Language:
              schema:
                type: string
                description: >-
                  The language of translatable strings in the response (see RFC2616-sec14.12).
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented      
          
  '/offers/{offerId}/fares/{fareId}/nearby':             
    get:
      tags:
        - Fares
      summary: >-
        Allows validating reservation selection parameters near to a reference place.
      description: >-
        Check whether the fare reservation can be located near the provided reference place (given by
        coach number and place number). If selected place preferences of the customer are provided they
        are checked for availability and the in combination available preferences are returned.
        This service provides the availability service to be compliant with existing 90918-1 services (as-if-reservation).
      operationId: validateFareReservationNearbyId
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage"
        - in: path
          name: offerId
          schema:
            type: string
          required: true
          description: ID of the offer.
        - in: path
          name: fareId
          schema:
            type: string
          required: true
          description: ID of the fare where to validate the place availability
        - in: query
          name: coachNumber
          description: coach of the referenced place
          schema:
            type: string
          required: true
        - in: query
          name: placeNumber
          description: place number of the referenced place
          schema:
            type: string   
          required: true
        - in: query
          name: preferences
          description: >-
            Place preferences (see code list Reservation Preferences) the customer wants to have 
          schema:
            type: array
            items:
              type: string
        - in: query
          name: preferenceBundles
          description: >-
            Place preferences the customer wants to have applying to a selection of passengers or transportables only
          schema:
            type: array
            items:
              type: object
              properties:
                passengerId:
                  type: string
                preferences:
                 description: >-
                    Place preferences (see code list Reservation Preferences) the customer wants to have 
                 type: array
                 items:
                   type: string
      responses:
        '200':
          description: Places available
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
                  reservation:
                    $ref: '#/components/schemas/AvailablePlacePreferences'
          headers:
            Content-Language:
              schema:
                type: string
                description: >-
                  The language of translatable strings in the response (see RFC2616-sec14.12).
        '400':
           $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented      
          
  '/offers/{offerId}/fares/{fareId}/place-map':             
    get:
      tags:
        - Fares
      summary: Provides available places for place selection
      description: >-
        Provide the availability per place to be displayed in a graphical place map for place selection.
        If selected place preferences of the customer are provided they are checked for availability and the in
        combination available preferences are returned.
      operationId: provideFareReservationPlaceMap
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage"
        - in: path
          name: offerId
          schema:
            type: string
          required: true
          description: ID of the offer.
        - in: path
          name: fareId
          schema:
            type: string
          required: true
          description: ID of the reservation fare where to get the place availability
        - in: query
          name: preferences
          description: >-
            Place preferences (see code list PLacePreferences) the customer wants to have 
          schema:
            type: array
            items:
              type: string
        - in: query
          name: preferenceBundles
          description: >-
            Place preferences the customer wants to have applying to a selection of passengers or transportables only
          schema:
            type: array
            items:
              type: object
              properties:
                passengerId:
                  type: string
                preferences:
                 description: >-
                    Place preferences (see code list PlacePreferences) the customer wants to have 
                 type: array
                 items:
                   type: string
      responses:
        '200':
          description: selectable places
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
                  reservation:
                    $ref: '#/components/schemas/PlaceAvailability'
          headers:
            Content-Language:
              schema:
                type: string
                description: >-
                  The language of translatable strings in the response (see RFC2616-sec14.12).
        '400':
           $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented            

  /bookings/{bookingId}/passengers/{passengerId}:
    get:
      tags:
        - Passengers
      summary: Returns the passenger's information at booking step.
      operationId: getBookingPassengersId
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage"
        - in: path
          name: bookingId
          schema:
            type: string
            format: uuid
          required: true
          description: ID of the booking the passenger is in.
        - in: path
          name: passengerId
          schema:
            type: string
            format: uuid
          required: true
          description: ID of the passenger to get.
      responses:
        '200':
          description: Passenger found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Passenger'
          headers:
            Content-Language:
              schema:
                type: string
                description: >-
                  The language of translatable strings in the response (see RFC2616-sec14.12).
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented
    patch:
      tags:
        - Passengers
      summary: Allows updating a passenger's information at booking step.
      operationId: patchBookingPassenger
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage"
        - in: path
          name: bookingId
          schema:
            type: string
            format: uuid
          required: true
          description: ID of the booking the passenger is in.
        - in: path
          name: passengerId
          schema:
            type: string
            format: uuid
          required: true
          description: ID of the passenger to get.
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Passenger'
      responses:
        '200':
          description: Passenger successfully patched
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Passenger'
          headers:
            Content-Language:
              schema:
                type: string
                description: >-
                  The language of translatable strings in the response (see RFC2616-sec14.12).
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '409':
          $ref: '#/components/responses/ConflictResponse'
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented
          
  /products/{productId}:
    get:
      tags:
        - Products
      summary: Returns a product for the id provided.
      operationId: getProductsId
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage"
        - in: path
          name: productId
          schema:
            type: string
            description: unique and opaque ID of the product
          required: true
          description: ID of the product to get.
      responses:
        '200':
          description: Product found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Product'
          headers:
            Cache-Control:
              schema:
                type: string
                default: 'public, max-age=43200'
                description: >-
                  A product resource has a long time to live to allow long-term caching. Any update of the product 
                  information will lead to the creation of a new resource.
            Content-Language:
              schema:
                type: string
                description: >-
                  The language of translatable strings in the response (see RFC2616-sec14.12).
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented       
 
  /bookings/search:
    post:
      tags:
        - Bookings
      summary: Allows to search for and find bookings based on a set of criteria.
      description: >-
        There are searching criteria that need to be supported. by passenger 
        attributes (first name, name, date-of-birth), by booking reference (e.g. PNR, 
        Auftragsnummer) or by fulfillment reference (e.g. ticket number).
      operationId: getBookings
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage"
        - in: query
          name: embed
          description: >-
            Influences whether referenced resources are returned in full or as references only.
          schema:
            type: array
            items:
              type: string
              enum:
                - ALL
                - BOOKINGS
                - BOOKINGS.BOOKEDOFFERS.TRIP
                - BOOKINGS.BOOKEDOFFERS.TRIP.LOCATIONS
                - BOOKINGS.BOOKEDOFFERS
                - BOOKINGS.BOOKEDOFFERS.OFFERPARTS
                - BOOKINGS.PASSENGERS
                - BOOKINGS.TICKETS  
                - NONE
            default: [ALL]
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BookingSearchParameter'          
      responses:
        '200':
          description: Booking ids found
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
                  searchResults:
                    $ref: '#/components/schemas/BookingSearchReply'  
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '409':
          $ref: '#/components/responses/ConflictResponse'
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented
          
  /bookings:
    post:
      tags:
        - Bookings
      summary: Allows to create a booking based on a previously requested offer.
      operationId: postBookings
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage"
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BookingRequest'      
      responses:
        '200':
          description: >- 
            Booking prebooked
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
                  booking:
                    $ref: '#/components/schemas/Booking'
          headers:
            Content-Language:
              schema:
                type: string
                description: >-
                  The language of translatable strings in the response (see RFC2616-sec14.12).
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '409':
          $ref: '#/components/responses/ConflictResponse'
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented

  /bookings/{bookingId}:
    get:
      tags:
        - Bookings
      summary: Returns a booking with the id provided.
      operationId: getBookingsId
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage"
        - in: path
          name: bookingId
          schema:
            type: string
            format: uuid
          required: true
          description: ID of the product to get.
        - in: query
          name: embed
          description: >-
            Influences whether referenced resources are returned in full or as references only.
          schema:
            type: array
            items:
              type: string
              enum:
                - ALL
                - BOOKEDOFFERS.TRIP
                - BOOKEDOFFERS.TRIP.LOCATIONS
                - BOOKEDOFFERS
                - BOOKEDOFFERS.OFFERPARTS
                - PASSENGERS
                - TICKETS
                - REFUND_PROPOSITIONS
                - NONE
            default: [ALL]
      responses:
        '200':
          description: booking found
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
                  booking:
                    $ref: '#/components/schemas/Booking'
          headers:
            Content-Language:
              schema:
                type: string
                description: >-
                  The language of translatable strings in the response (see RFC2616-sec14.12).
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented
    delete:
      tags:
        - Bookings
      summary: Deletes the booking with the id provided. 
      description: >-
        It is only possible before the booking is confirmed or in case of a technical problem in confirming multiple 
        independent bookings within a sales transaction. Deletes on a confirmed booking must be documented
        and evidence on the issue must be provided on request. 
        The delete on a confirmed booking is allowed immediately after the confirmation of the booking, 
        but must be repeated according to the error handling rules in case the delete fails.
      operationId: deleteBookingsId
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - in: path
          name: bookingId
          schema:
            type: string
            format: uuid
          required: true
          description: ID of the booking to delete.
      responses:
        '200':
          description: Booking successfully cancelled
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '409':
          $ref: '#/components/responses/ConflictResponse'        
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented
    patch:
      tags:
        - Bookings
      summary: Allows updating the fulfillment type of the booking.
      operationId: confirmBooking
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage"
        - in: path
          name: bookingId
          schema:
            type: string
            format: uuid
          required: true
          description: ID of the booking to be patched      
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BookingPatchRequest'
      responses:
        '200': 
          description: booking fulfillment type updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
                  booking:
                    $ref: '#/components/schemas/Booking'
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '409':
          $ref: '#/components/responses/ConflictResponse'
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented
   
  /bookings/{bookingId}/fulfillments:
    post:
      tags:
        - Fulfillments
      summary:  Triggers the fulfillment of the booking.
      operationId: postFulfillments
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage"
        - in: path
          name: bookingId
          schema:
            type: string
            format: uuid
          required: true
          description: ID of the booking to be patched        
      responses:
        '200':
          description: >-
            Fulfillment successfully completed
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
                  fulfillments:
                    type: array
                    items:
                      $ref: '#/components/schemas/Fulfillment'
        '202': 
          description: >- 
            Fulfillment successfully initiated, retrieve booking to retrieve the fulfillment documents
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '409':
          $ref: '#/components/responses/ConflictResponse'            
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented
    patch:
      tags:
        - Fulfillments
      summary: Allows the effective fulfillment of one ore more confirmed fulfillment. 
      operationId: patchFulfillment
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage"
        - in: path
          name: bookingId
          schema:
            type: string
            format: uuid
          required: true
          description: ID of the booking to be patched        
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FulfillmentsPatch'
      responses:
        '200':
          description: >-
            Fulfillment successfully completed
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
                  fulfillments:
                    type: array
                    items:
                      $ref: '#/components/schemas/Fulfillment'
        '202': 
          description: >- 
            Fulfillment successfully initiated, retrieve booking to retrieve the fulfillment documents
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '409':
          $ref: '#/components/responses/ConflictResponse'        
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented
          
  /fulfillments/{fulfillmentId}:
    get:
      tags:
        - Fulfillments
      summary: Returns the fulfillment, aka. ticket for the provided id.
      operationId: getFulfillmentId
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage"
        - in: path
          name: fulfillmentId
          schema:
            type: string
            format: uuid
          required: true
          description: ID of the product to get.
      responses:
        '200':
          description: fulfillment found
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
                  fulfillment:
                    $ref: '#/components/schemas/Fulfillment'
          headers:
            Content-Language:
              schema:
                type: string
                description: >-
                  The language of translatable strings in the response (see RFC2616-sec14.12).
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented
          
  /bookings/{bookingId}/refundOffers:
    post:
      tags:
        - Refund
      summary: Initiates a refund process by creating a RefundOffer resource.
      description:
        The RefundOffer contains the required information on the potential operation. One refund offer can then be 
        accepted via a PATCH, deleted or left to die at the end of its lifetime.
      operationId: postRefundOffersBookingId
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage"
        - in: path
          name: bookingId
          schema:
            type: string
            format: uuid
          required: true
          description: ID of the booking.      
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RefundOfferRequest'
      responses:
        '200': 
          description: Refund offer created
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
                  refundOffersCollection:
                    $ref: '#/components/schemas/RefundOffersCollection'
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '409':
          $ref: '#/components/responses/ConflictResponse'       
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented
        
  /bookings/{bookingId}/refundOffers/{refundOfferId}:
    get:
      tags:
        - Refund
      summary: Returns the refund offer for the ids provided.
      operationId: getRefundOffersId
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage"
        - in: path
          name: bookingId
          schema:
            type: string
            format: uuid
          required: true
          description: ID of the booking  
        - in: path
          name: refundOfferId
          schema:
            type: string
            format: uuid
          required: true
          description: ID of the refund offer to get.
      responses:
        '200':
          description: RefundOffer found
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
                  refundOffer:
                    $ref: '#/components/schemas/RefundOffer'
          headers:
            Content-Language:
              schema:
                type: string
                description: >-
                  The language of translatable strings in the response (see RFC2616-sec14.12).
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented
    patch:
      tags:
        - Refund
      summary: Allows to accept and confirm a refund offer.
      operationId: patchRefundOffersId
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage"
        - in: path
          name: bookingId
          schema:
            type: string
            format: uuid
          required: true
          description: ID of the offer the offerPart is part of.      
        - in: path
          name: refundOfferId
          schema:
            type: string
            format: uuid
          required: true
          description: ID of the product to get.
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RefundOfferConfirm'
      responses:
        '200':
          description: RefundOffer confirmed
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
                  refundOffer:
                    $ref: '#/components/schemas/RefundOffer'
          headers:
            Content-Language:
              schema:
                type: string
                description: >-
                  The language of translatable strings in the response (see RFC2616-sec14.12).
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '409':
          $ref: '#/components/responses/ConflictResponse'
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented
    delete:
      tags:
        - Refund
      summary: Deletes a refundOffer without waiting for expiry.
      operationId: deleteRefundOffersId
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - in: path
          name: bookingId
          schema:
            type: string
            format: uuid
          required: true
          description: ID of the offer the offerPart is part of.      
        - in: path
          name: refundOfferId
          schema:
            type: string
            format: uuid
          required: true
          description: ID of the product to delete.
      responses:
        '200':
          description: RefundOffer removed
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
                  fulfillments:
                    type: array
                    items:
                      $ref: '#/components/schemas/Fulfillment'
          headers:
            Content-Language:
              schema:
                type: string
                description: >-
                  The language of translatable strings in the response (see RFC2616-sec14.12).
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '409':
          $ref: '#/components/responses/ConflictResponse'
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented
          
  /bookings/{bookingId}/exchangeOperations/{exchangeOperationId}:
    get:
      tags:
        - Exchange
      summary: >-
        Returns the exchange operation with the id provided. It may be a provisional or a confirmed exchange.
      operationId: getExchangeOperation
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage"
        - in: path
          name: bookingId
          schema:
            type: string
            format: uuid
          required: true
          description: ID of the booking  
        - in: path
          name: exchangeOperationId
          schema:
            type: string
            format: uuid
          required: true
          description: ID of the exchange operation to get.
        - in: query
          name: embed
          description: >-
            Influences whether referenced resources are returned in full or as references only.
          schema:
            type: array
            items:
              type: string
              enum:
                - ALL
                - TRIP
                - TRIP.LOCATIONS
                - OFFERS
                - OFFERS.OFFERPARTS
                - OFFERS.OFFERPARTS.PRODUCTS
                - PASSENGERS
            default: [ALL]
      responses:
        '200':
          description: ExchangeOperation found
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
                  exchangeOperation:
                    $ref: '#/components/schemas/ExchangeOperation'
          headers:
            Content-Language:
              schema:
                type: string
                description: >-
                  The language of translatable strings in the response (see RFC2616-sec14.12).
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented  
    patch:
      tags:
        - Exchange
      summary: >-
        Allows to update an ongoing exchange operation. 
      operationId: patchExchangeOperation
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage"
        - in: path
          name: bookingId
          schema:
            type: string
            format: uuid
          required: true
          description: ID of the booking to be exchanged.  
        - in: path
          name: exchangeOperationId
          schema:
            type: string
            format: uuid
          required: true
          description: ID of the exchange operation.
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExchangeOperationPatchRequest'
      responses:
        '200':
          description: Exchange successfully completed
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
                  exchangeOperation:
                    $ref: '#/components/schemas/ExchangeOperation'
          headers:
            Content-Language:
              schema:
                type: string
                description: >-
                  The language of translatable strings in the response (see RFC2616-sec14.12).
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '409':
          $ref: '#/components/responses/ConflictResponse'
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented
    delete:
      tags:
        - Exchange
      summary: >-
        Cancels an ongoing exchange operation in provisional state. 
      operationId: deleteExchangeOperation
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - in: path
          name: bookingId
          schema:
            type: string
            format: uuid
          required: true
          description: ID of the booking containing the exchange operation
        - in: path
          name: exchangeOperationId
          schema:
            type: string
            format: uuid
          required: true
          description: ID of the exchangeOperation to delete.
      responses:
        '200':
          description: ExchangeOperation removed
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
          headers:
            Content-Language:
              schema:
                type: string
                description: >-
                  The language of translatable strings in the response (see RFC2616-sec14.12).
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '409':
          $ref: '#/components/responses/ConflictResponse'
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented

  /exchange-trip-offers-collection:
    post:
      tags:
        - Exchange
      summary: >-
        Returns different exchange offers for a specified fulfillments submitted given requested new trip 
        characteristics. 
      operationId: postExchangeTripOffersCollection
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage"
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExchangeTripOfferRequest'
      responses:
        '200':
          description: Collection of exchange trip offers found
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
                  id:
                    type: string
                    format: uuid
                  exchangeTripOffers:
                    type: array
                    items:
                      $ref: '#/components/schemas/ExchangeTripOffer'
                  scrollBackContext:
                    type: string
                    description: >-
                      Scroll reference for the current response to scroll backward. (Value
                      depends on underlying system.)
                  scrollForwardContext:
                    type: string
                    description: >-
                      Scroll reference for the current response to scroll forward.
                      (Value depends on underlying system.)
                  links:
                    type: array
                    items:
                      $ref: '#/components/schemas/Link'
                required:
                  - id
                  - exchangeTripOffers
          headers:
            Content-Language:
              schema:
                type: string
                description: >-
                  The language of translatable strings in the response (see RFC2616-sec14.12).
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '409':
          $ref: '#/components/responses/ConflictResponse'
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented

  /exchange-trip-offers-collection/{exchangeTripOffersCollectionId}:
    get:
      tags:
        - Exchange
      summary: >-
        Returns different offers and trips for a specified origin and destination (and via).
      operationId: getExchangeTripOffersCollectionId
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage"
        - in: path
          name: exchangeTripOffersCollectionId
          schema:
            type: string
            format: uuid
          required: true
          description: ID of the trip to get.
        - name: scrollContext
          in: query
          description: >-
            Based on a previous search-response, earlier or later connections
            for the same trip can be retrieved by scrolling back and forth (by
            a pointer-context). You must use the same request parameters as in
            the original trips-request and the given values in the response for
            either "ScrollBack-Context" or "ScrollForward-Context" for optional
            scrolling.
          schema:
            type: string
          required: false                   
        - in: query
          name: embed
          description: >-
            Influences whether referenced resources are returned in full or as references only. 
          schema:
            type: array
            items:
              type: string
              enum:
                - ALL
                - TRIPOFFERS
                - TRIPOFFERS.TRIPS
                - TRIPOFFERS.TRIPS.LOCATIONS
                - TRIPOFFERS.OFFERS
                - TRIPOFFERS.OFFERS.OFFERPARTS
                - TRIPOFFERS.OFFERS.OFFERPARTS.PRODUCTS
                - TRIPOFFERS.PASSENGERS
                - NONE
            default: [ALL]
      responses:
        '200':
          description: Trip Offer Collection(s) found
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                     $ref: '#/components/schemas/WarningMessageList'
                  id:
                    type: string
                    format: uuid
                  fulfillmentIds:
                    type: array
                    items:
                      type: string
                      format: uuid
                  overruleCode: 
                    $ref: '#/components/schemas/OverruleCode'
                  exchangeTripOffers:
                    type: array
                    items:
                      $ref: '#/components/schemas/ExchangeTripOffer'
                  scrollBackContext:
                    type: string
                    description: >-
                      Scroll reference for the current response to scroll backward. (Value
                      depends on underlying system.)
                  scrollForwardContext:
                    type: string
                    description: >-
                      Scroll reference for the current response to scroll forward.
                      (Value depends on underlying system.)
                  links:
                    type: array
                    items:
                      $ref: '#/components/schemas/Link'
                required:
                  - id
                  - exchangeTripOffers
          headers:
            Content-Language:
              schema:
                type: string
                description: >-
                  The language of translatable strings in the response (see RFC2616-sec14.12).
        '400':
          $ref: '#/components/responses/BadRequestResponse'         
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented
          

  /exchange-trip-offers/{exchangeTripOfferId}:
    get:
      tags:
        - Exchange
      summary: >-
        Returns different offers for a specified trip offer id.
      operationId: getExchangeTripOffersId
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage" 
        - in: path
          name: exchangeTripOfferId
          schema:
            type: string
            format: uuid
          required: true
          description: ID of the trip to get.
        - in: query
          name: embed
          description: >-
            Influences whether referenced resources are returned in full or as references only. 
          schema:
            type: array
            items:
              type: string
              enum:
                - ALL              
                - TRIPS
                - TRIPS.LOCATIONS
                - OFFERS
                - OFFERS.OFFERPARTS
                - OFFERS.OFFERPARTS.PRODUCTS
                - PASSENGERS
                - NONE
            default: [ALL]
      responses:
        '200':
          description: Trip offer found
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
                  tripOffer:
                    $ref: '#/components/schemas/ExchangeTripOffer'
          headers:
            Content-Language:
              schema:
                type: string
                description: >-
                  The language of translatable strings in the response (see RFC2616-sec14.12).
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'      
        '501':
          description: Not implemented     

  /coachLayouts:
    get:
      tags:
        - CoachLayouts 
      summary: Returns all coach layouts.
      description: >-
        Retrieve the coach layout description needed for graphical reservation. The coach
        layouts can either be retrieved as a complete list or specificity for a train identified via offerId and reservationId or fareId
      operationId: getCoachLayouts
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage"
        - in: query 
          description: id of the trip to offer
          name: offerId
          schema:
            type: string
            format: uuid
          required: false
        - in: query 
          description: id of the reservation offer part within the offer
          name: reservationId
          schema:
            type: string
            format: uuid
          required: false
        - in: query 
          description: id of the fare within the offer
          name: fareId
          schema:
            type: string
            format: uuid
          required: false          
        - in: query
          name: embed
          description: >-
            Influences whether referenced resources are returned in full or as references only.
          schema:
            type: array
            items:
              type: string
              enum:
                - ALL
                - LAYOUT
                - NONE
            default: [ALL]
      responses:
        '200':
          description: coach layouts
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
                  selectablePlaces:
                    $ref: '#/components/schemas/PlaceAvailability'
                  layouts:
                    type: array
                    items:
                      $ref: '#/components/schemas/CoachLayout'
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '500':
           $ref: '#/components/responses/InternalServerErrorResponse'         
        '501':
          description: Not implemented

  /coachLayouts/{layoutId}:
    get:
      tags:
        - CoachLayouts
      summary: Returns a coach layout for a provided id.
      description: >-
        Retrieve a coach layout description needed for graphical reservation for a given layout id.
      operationId: getCoachLayoutsLayoutId
      parameters:
        - $ref: "#/components/parameters/accessToken"
        - $ref: "#/components/parameters/acceptLanguage"
        - in: path
          description: id of the layout
          name: layoutId
          schema:
            type: string
          required: true
      responses:
        '200':
          description: coach layouts
          content:
            application/json:
              schema:
                type: object
                properties:
                  warnings:
                    $ref: '#/components/schemas/WarningMessageList'
                  coachLayout: 
                    $ref: '#/components/schemas/CoachLayout'
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '500':
          $ref: '#/components/responses/InternalServerErrorResponse'
        '501':
          description: Not implemented


## Components
components:
  parameters:
    accessToken:
      name: Access-Token 
      in: header
      description: >-
        OAuth2 token used to authenticate the consumer API. Refer to the implementation documentation
        for information on how to get a token.
      required: true
      schema:
        type: string

    acceptLanguage:
      name: Accept-Language
      in: header
      description: >-
        Describes the set of natural languages that are preferred for localized text in the response
        to the request (see RFC2616-sec14.4). Supporting English (en) is a must.
      schema:
        type: string
      required: false

  responses:
    BadRequestResponse:
      description: Bad Request (400)
      content:
        "application/problem+json":
          schema:
            $ref: '#/components/schemas/Problem'

    ConflictResponse:
      description: Conflict (409)
      content:
        "application/problem+json":
          schema:
            $ref: '#/components/schemas/Problem'    

    InternalServerErrorResponse:
      description: Internal Server Error (500)
      content:
        "application/problem+json":
          schema:
            $ref: '#/components/schemas/Problem'

  schemas:
    WarningMessageList:
      type: array
      items:
        type: object
        properties:
          code:
            type: string
          text:
            type: string
          elementList:
            type: array
            items:
              $ref: '#/components/schemas/Resource'
        description: >-
         This element can be used to pass non-blocking information or events,
         such as a price difference with the initially offered price at booking time.
  
    Resource:
      type: object
      description: used to represent a non-specified resource in the API.
      properties:
        id:
          type: string
          description: unique id of this resource on this server.
        title:
          type: string
          example: Bruxelles-Midi    
        type:
          type: string
          enum:
            - LOCATION
            - TRIP
            - TRIPOFFER
            - OFFER
            - OFFERPART
            - PASSENGER
            - BOOKING
            - FULFILLMENT
            - REFUNDOFFER
        href:
          type: string
          format: url
          example: 'http://some.provider/location/2345'
      required:
        - id
        - title
        - type
        - href

    PlaceInformationRequest: ## OJP
      allOf:
        - oneOf: 
          - $ref: "#/components/schemas/InitialPlaceInput"
          - $ref: "#/components/schemas/PlaceRefStructure"
        - type: object
          properties:
            restrictions:
              $ref: "#/components/schemas/PlaceParam"
            
    PlaceParam: ## OJP
      description: >-
        More parameters for restricting the request.
      allOf:
#        - $ref: "#/components/schemas/PlaceDataFilter"   # Out of scope
        - $ref: "#/components/schemas/PlacePolicy"
        
    PlacePolicy: ## OJP
      properties:
        #language:   # Not supported, language shall be set in header
        #  type: string
        numberOfResults:
          description: >-
            Maximum number of results to be returned. The service is allowed to return fewer objects if reasonable
            or otherwise appropriate.
          type: number
          format: int32
          minimum: 1
        #continueAt:   # Out of scope
        #  type: number
        #  format: int32
        #includePtModes:    # Out of scope
        #  type: boolean

    InitialPlaceInput: ## OJP
      description: >-
        Initial input for the place information request. 
        This input defines what is originally looked for.
      type: object
      properties:
        initialInput:
          anyOf:
            - $ref: "#/components/schemas/Name"
            - $ref: "#/components/schemas/LocationStructure"
  #         - $ref: "#/components/schemas/GeoRestriction"   # Out of scope
  #         - $ref: "#/components/schemas/AllowedSystemId"    # Out of scope

    Name:  ## OJP
      description: >-
        Name of the place object which is looked after. This is usually the user's input. If not given,
        the name of the resulting place objects is not relevant.
      type: object
      properties:
        name:
          type: string
          example: "Bern Bärengraben"

    PlaceInformationResponse:  ## OJP
      type: object
      properties:
        # placeInformationResponseContext:   # Out of scope
        #   $ref: "#/components/schemas/PlaceContext"
        # continueAt:   # Ouf of scope
        #   type: string
        placeResults:
          type: array
          items:
            $ref: "#/components/schemas/PlaceResult"

    PlaceResult:  ## OJP
      type: object
      required:
        - results
        - complete
      properties:
        place:
          $ref: "#/components/schemas/Place"  
        complete:
          description: >-
            States whether the included place is complete or needs further refinement. Only complete places
            are fully resolved and can be used in e.g. trip requests. Incomplete places have to be refined 
            entering them once again into a PlaceInformationRequest.
          type: boolean
        probability:
          description: >-
            Probability, that this result is the one meant by the user's input. Value should be between 0 and 1.
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
        modes:
          description:
            List of transport modes that call at this place object. This list should only be filled in case of
            stop points or stop places – and only when explicitly requested.
          type: array
          items:
            $ref: "#/components/schemas/Mode"

    TripRequest:  ## OJP
      required:
        - destination
        - origin
      type: object
      properties:
        # Array out of Scope
        origin:
          description: >-
            Specifies the origin situation from where the user wants to start.
          $ref: "#/components/schemas/PlaceContext"
        # Array out of Scope
        destination:
          description: >-
            Specifies the destination situation where the user is heading to.
          $ref: "#/components/schemas/PlaceContext"
        # Array out of Scope
        via:
          description: >-
            Ordered series of points where the journey must pass through. If more
            than one via point is given all of them must be obeyed - in the correct
            order. The server is allowed to replace a via stop by equivalent stops.
          type: array
          items:
            $ref: "#/components/schemas/TripVia"
        # notVia:   # Out of scope
        #   description: >-
        #     Not-via restrictions for a TRIP, i.e. SCHEDULED STOP POINTs or STOP PLACEs
        #     that the TRIP is not allowed to pass through. If more than one not via point 
        #     is given all of them must be obeyed.
        #   oneOf:
        #     - $ref: "#/components/schemas/StopPointRef"
        #     - $ref: "#/components/schemas/StopPlaceRef"
        # noChangesAt:   # Out of scope
        #   description: >-
        #     No-change-at restrictions for a TRIP, i.e. SCHEDULED STOP POINTs or STOP PLACEs 
        #     at which no TRANSFER is allowed within a TRIP
        #   oneOf:
        #     - $ref: "#/components/schemas/StopPointRef"
        #     - $ref: "#/components/schemas/StopPlaceRef"
        params:
          description: >-
            Options to control the search behaviour and response contents.
          $ref: "#/components/schemas/TripParam"

    DepArrTimeStructure:  ## OJP
      type: object
      properties:
        depArrTime:
          type: string
          format: date-time
      required:
        - depArrTime

    TimeAllowanceStructure:  ## OJP
      type: object
      properties:
        timeAllowance:
          type: string
          format: duration
          example: "120S"
      required:
        - timeAllowance

    PlacePlaceStructure:  ## OJP Hack
      oneOf:
        - $ref: "#/components/schemas/PlaceRefStructure"
        - $ref: "#/components/schemas/TripPlaceStructure"

    PlaceTimeStructure:  ## OJP Hack
      oneOf:
        - $ref: "#/components/schemas/DepArrTimeStructure"
        - $ref: "#/components/schemas/TimeAllowanceStructure"

    PlaceContext:  ## OJP
      type: object
      # NOTICE: there is a bug in the Swagger-UI which prevents
      # the correct structure to pop up when selecting.
      # This should without the place and time layer.
      properties:
        place:
          $ref: "#/components/schemas/PlacePlaceStructure"
        time:
          $ref: "#/components/schemas/PlaceTimeStructure"
        # individualTransportOptions:
        # - $ref: "#/components/schemas/IndividualTransportOptions"
      required:
        - place

    StopPointRefStructure:  ## OJP
      type: object
      required:
        - stopPointRef
      properties:
        stopPointRef:
          $ref: "#/components/schemas/StopPointRef"

    StopPlaceRefStructure:  ## OJP
      type: object
      required:
        - stopPlaceRef
      properties:
        stopPlaceRef:
          $ref: "#/components/schemas/StopPlaceRef"

    GeoPositionStructure:  ## OJP
      type: object
      required:
        - geoPosition
      properties:
        geoPosition:
          $ref: "#/components/schemas/LocationStructure"

    TopographicPlaceRefStructure:  ## OJP
      type: object
      required:
        - topographicPlaceRef
      properties:
        topographicPlaceRef:
          $ref: "#/components/schemas/TopographicPlaceRef"

    PointOfInterestRefStructure:  ## OJP
      type: object
      required:
        - pointOfInterestRef
      properties:
        pointOfInterestRef:
          $ref: "#/components/schemas/PointOfInterestRef"

    AddressRefStructure:  ## OJP
      type: object
      required:
        - addressRef
      properties:
        addressRef:
          $ref: "#/components/schemas/AddressRef"

    LocationNameStructure:  ## OJP
      type: object
      required:
        - locationName
      properties:
        locationName:
          type: string
          example: Bern

    PlaceRefStructure:  ## OJP
      type: object
      required:
        - placeRef
      properties:
        placeRef:
          $ref: "#/components/schemas/PlaceRef"

    PlaceRef:  ## OJP
      description: >-
        Reference to a geographic PLACE of any type which may be specified as the origin or destination of a trip.
      allOf:
        - oneOf:
          - $ref: "#/components/schemas/StopPointRefStructure"
          - $ref: "#/components/schemas/StopPlaceRefStructure"
          - $ref: "#/components/schemas/GeoPositionStructure"
          - $ref: "#/components/schemas/TopographicPlaceRefStructure"
          - $ref: "#/components/schemas/PointOfInterestRefStructure"
          - $ref: "#/components/schemas/AddressRefStructure"
        - $ref: "#/components/schemas/LocationNameStructure"

    TripVia:  ## OJP
      description: >-
        Via restriction for a trip.
      required:
        - viaPoint 
      properties:
        viaPoint:
          $ref: "#/components/schemas/PlaceRef"
        dwellTime:
          type: string
          format: duration
          example: "30S"

    TripPlaceStructure:  ## OJP
      type: object
      properties:
        tripPlace:
          $ref: "#/components/schemas/TripPlace"
      required:
        - tripPlace

    TripPlace:  ## OJP
      description: >-
        A trip place represents the current logical position of a journey service. It can be 
        used similarly to a place e.g. for starting a new trip requests from within this service. 
        A trip place does not(!) describe the relative position of a traveller within a vehicle, 
        e.g. the seat.
      type: object
      required:
        - operatingDayRef
        - journeyRef
      properties:
        operatingDayRef:
          $ref: "#/components/schemas/OperationDayRef"
        journeyRef:
          $ref: "#/components/schemas/JourneyRef"

    BaseTripContentFilter:  ## OJP
      type: object
      properties:
        includeTrackSections:
          type: boolean
          description: Whether the result should include TrackSection elements to describe the geographic route of each journey leg.
          default: false
        includeLegProjection:
          type: boolean
          description: Whether the result should include the geographic projection (coordinates) of each journey leg.
          default: false
        includeTurnDescription:
          type: boolean
          description: Whether the result should include turn-by-turn instructions for each journey leg.
          default: false
        includeAccessibility:
          type: boolean
          description: Whether the result should include accessibility information.
          default: false
        includePlacesContext:
          type: boolean
          description: Whether the place context is needed. If a requestor has that information already, the response can be made slimmer, when set to false.
          default: true
        includeSituationsContext:
          type: boolean
          description: Whether the situation context is needed. If a requestor has that information by other means or can't process it, the response can be made slimmer, when set to false.
          default: true

    TripContentFilter:  ## OJP
      type: object
      properties:
        includeIntermediateStops:
          description: Whether the result should include intermediate stops (between the passenger's board and alight stops).
          type: boolean
          default: true
        includeFare:
          description: Whether the result should include fare information.
          type: boolean
          default: true
        includeOperatingDays:
          description: Whether the result should include operating day information - as encoded bit string and in natural language.
          type: boolean
          default: true
        tripSummaryOnly:
          description: If true, then the response will contain only summaries of the found trips.
          type: boolean
          default: false

    BaseTripPolicyFilter:  ## OJP
      type: object
      properties:        
        noSingleStep:
          description: The user is not able to climb one step.
          type: boolean
          default: false
        noStairs:
          description: The user is not able to walk up/down stairs.
          type: boolean
          default: false
        noEscalator:
          type: boolean
          description: The user is not able to use an escalator.
          default: false
        noElevator:
          type: boolean
          description: The user is not able to use an elevator.
          default: false
        noRamp:
          type: boolean
          description: The user is not able to use an ramp.
          default: false
        noSight:
          type: boolean
          description: The user is not able to see.
          default: false

    TripMobilityFilter:  ## OJP
      type: object
      properties:
        levelEntrance:
          description: >-
            The user needs vehicles with level entrance between platform and vehicle, f.e. 
            for wheelchair access.
          type: boolean
          default: false
        bikeTransport:
          description: >-
            The user wants to carry a bike on public transport.
          type: boolean
          default: false
        walkSpeed:
          description: >-
            Deviation from average walk speed in percent. 100% percent is average speed. 
            Less than 100 % slower, Greater than 150% faster.
          type: number
          format: uint8
          default: 100
        additionalTransferTime:
          description: >-
            Additional time added to all transfers (also to transfers between individual to
            public transport).
          type: string
          format: duration
          example: 0S

    NumberOfResultsGroup:  ## OJP
      description: >-
        Parameter to control the number of TRIP results before/after a point in time. May NOT be used when departure time at 
        origin AND arrival time at destination are set.
      type: object
      properties:        
        numberOfResultsBefore:
          type: number
          format: int32
          default: 0 
        numberOfResultsAfter:
          type: number
          format: int32
          default: 5
      required:
        - numberOfResultsBefore
        - numberOfResultsAfter

    PtModeFilter:  ## OJP
      description: >-
        List of public transport modes ([from SIRI] mode of public transport service, corresponds
        to VEHICLE MODE) to include or exclude.
      type: object
      properties:
        exclude:
          description: Whether modes in list are to include or exclude from search.
          type: boolean
          default: True
        ptMode:
          description: List of PT Transport modes to include/exclude.
          type: array
          items:
            $ref: "#/components/schemas/VehicleModesOfTransportEnumeration"

    LineDirection:  ## OJP
      description: Lines/Directions to include/exclude.
      type: object
      properties:
        lineRef:
          description: Line Reference.
          type: string
        directionRef:
          description: Direction Reference.
          type: string

    LineDirectionFilter:  ## OJP
      description: Filter for in/exclusion of lines (and directions).
      type: object
      properties:
        lineDirections:
          description: >-
            Reference a GROUP of DIRECTIONs of the ROUTEs belonging to the same LINE created 
            for the purpose of filtering and organising timetables.
          type: array
          items:
            $ref: "#/components/schemas/LineDirection"
          minItems: 1
        exclude:
          description: Whether lines in list are to include or exclude from search. Default is exclude.
          type: boolean
          default: True
      required:
        - lineDirections

    OperatorFilter:  ## OJP
      description: Filter for in/exclusion of transport operators.
      type: object
      properties:
        exclude:
          description: Whether operators in list are to include or exclude from search.
          type: boolean
          default: True
        operatorRef:
          description: Reference to transport operator
          type: array
          items:
            type: string

    PrivateModeFilter:  ## OJP
      description: List of private mobility offers to include or exclude.
      type: object
      properties:
        exclude:
          description: Whether modes in list are to include or exclude from search.
          type: boolean
          default: True
        privateMode:
          description: List of private mobility offers to include/exclude.
          type: array
          items:
            $ref: "#/components/schemas/PrivateModesEnumeration"

    TripDataFilter:  ## OJP
      description: Data to be included/excluded from search, f.e. modes, operators.
      type: object
      properties:
        ptModeFilter:
          $ref: "#/components/schemas/PtModeFilter"
        lineFilter:
          $ref: "#/components/schemas/LineDirectionFilter"
        operatorFilter:
          $ref: "#/components/schemas/OperatorFilter"
        privateModeFilter:
          $ref: "#/components/schemas/PrivateModeFilter"

    BaseTripPolicy:  ## OJP
      description: Policies that control the trip search behaviour for both public and individual transport.
      type: object
      allOf:
        - oneOf:
          - type: object
            properties:
              numberOfResults:
                type: number
                format: uint8
                default: 1
          - $ref: "#/components/schemas/NumberOfResultsGroup"
        - type: object
          properties:
            ignoreRealtimeData:
              type: boolean
              default: false

    TripPolicy:  ## OJP
      description: Policies that control the trip search behaviour.
      type: object
      properties:        
        transferLimit:
          description: The maximum number of interchanges the user will accept per trip.
          type: number
          format: int8
          minimum: 0 
        optimisationMethod:
          $ref: "#/components/schemas/OptimisationMethod"
        itModesToCover:
          $ref: "#/components/schemas/IndividualMode"

    OptimisationMethod:  ## OJP
      description: >-
        The types of algorithm that can be used for planning a journey (fastest, least walking, etc).
      type: string
      enum:
        - FASTEST
        - MIN_CHANGES
        - LEAST_WALKING
        - LEAST_COST
        - EARLIEST_ARRIVAL 
        - LATEST_DEPARTURE 
        - EARLIEST_ARRIVAL_AND_LATEST_DEPARTURE
      default: FASTEST

    TripParam:  ## OJP
      description: Options to control the search behaviour and response contents.
      allOf:
        - $ref: "#/components/schemas/TripDataFilter"
        - $ref: "#/components/schemas/BaseTripPolicyFilter"
        - $ref: "#/components/schemas/TripMobilityFilter"
        - $ref: "#/components/schemas/BaseTripPolicy"
        - $ref: "#/components/schemas/TripPolicy"
        - $ref: "#/components/schemas/BaseTripContentFilter"
        - $ref: "#/components/schemas/TripContentFilter"
      #  - $ref: "#/components/schemas/FareParam"  ## Tackle next

    TripResponse:  ## OJP
      description: Trip response structure.
      required:
        - tripResult
      type: object
      properties:
        calcTime:
          type: integer
          minimum: 0
        # TODO: Implement this if you understand what it is.
        # tripResponseContext:
        #  $ref: "#/components/schemas/ResponseContext"
        tripResult:
          type: array
          items:
            $ref: "#/components/schemas/TripResult"

    TripResult:  ## OJP
      description: The trip results found by the server.
      allOf:
        - type: object
          properties:
            resultId:
              description: >-
                Id of this trip result for referencing purposes. Unique within trip response.
              type: string
              format: uuid
          required:
            - resultId
        - $ref: "#/components/schemas/ErrorMessage"
        - oneOf:
          - $ref: "#/components/schemas/Trip"
          - $ref: "#/components/schemas/TripSummary"
        # OOS - $ref: "#/components/schemas/TripFare" 

    ErrorMessage: ## OJP  --> Todo: Better map to Problem (RfC 7807)
      type: object
      properties:
        code:
          type: string
        text:
          type: string
      required:
        - code

    Trip:  ## OJP
      description: A complete trip from origin to destination
      type: object
      required:
        - tripId
        - duration
        - startTime
        - endTime
        - transfers
        - tripLegs
      properties:
        tripId:
          description: >-
            Id of this trip for referencing purposes. Unique within trip response.
          type: string
          format: uuid
        duration:
          description: Overall duration of the trip
          type: string
          example: "3500S"
        startTime:
          description: Departure time at origin.
          type: string
          format: date-time
        endTime:
          description: Arrival time at destination
          type: string
          format: date-time
        transfers:
          description: Number of interchanges
          type: number
          format: integer
          minimum: 0
        distance:
          description: Trip distance
          type: number
          format: integer
          minimum: 0
        tripLegs:
          description: Legs ot the trip
          type: array
          items:
            $ref: "#/components/schemas/TripLegStructure"
          minItems: 1
        operatingDays:
          $ref: "#/components/schemas/OperatingDays"
        # situationFullRef:
        #   $ref: "#/components/schemas/SituationFullRef"
        tripStatus:   # Ask Stefan
          $ref: "#/components/schemas/TripStatus"

    TripSummary: ## OJP
      description: A complete trip from origin to destination
      required:
        - tripId
      type: object
      properties:
        tripId:
          description: >-
            Id of this trip for referencing purposes. Unique within trip response.
          type: string
          format: uuid
        origin:
          description: >-
            Specifies the origin situation from where the user wants to start.
          $ref: "#/components/schemas/PlaceContext"
        destination:
          description: >-
            Specifies the destination situation where the user is heading to.
          $ref: "#/components/schemas/PlaceContext"
        duration:
          description: Overall duration of the trip
          type: string
          format: duration
          example: "3600S"
        startTime:
          description: Departure time at origin.
          type: string
          format: date-time
        endTime:
          description: Arrival time at destination
          type: string
          format: date-time
        ptTripLegs:
          description: Number of public transport trip legs
          type: integer
          minimum: 0
        distance:
          description: Trip distance
          type: number
          format: integer
          minimum: 0
        operatingDays:
          $ref: "#/components/schemas/OperatingDays"
        # Out of scope
        # situationFullRef:
        #   $ref: "#/components/schemas/SituationFullRef"

    OperatingDays:  ## OJP
      description: >-
         Day of public transport operation of which the characteristics are defined in a specific service
         calendar and which may last more than 24 hours.
      type: object
      properties:
        from:
          description: Start date of period.
          type: string
          format: date
          example: "2021-06-25"
        to:
          description: End date of period.
          type: string
          format: date
          example: "2021-06-30"
        pattern:
          description: >-
            Bit pattern for operating days between start date and end date. The length of the pattern is equal to the number
            of days from start date to end date. A bit value of "1" indicates that an event actually happens on the day that
            is represented by the bit position.
          type: string
          pattern: '^[01]+$'
          example: "101101"
        operatingDaysDescription:
          description: >-
            Textual description of the operation days, e.g. "monday to friday" or "not on holidays".
          type: string
      required:
        - from
        - to
        - pattern

    TripStatus:  ## OJP
      description: Parameters which describe the current status of a trip.
      type: object
      properties:
        unplanned:
          description: Whether this trip is an additional one that has not been planned.
          type: boolean
          default: false
        canceled:
          description: Whether this trip is cancelled and will not be run.
          type: boolean
          default: false
        deviation:
          description: Whether this trip deviates from the planned service pattern.
          type: boolean
          default: false
        delayed:
          description: Whether this trip is delayed.
          type: boolean
          default: false
        infeasible:
          description: Whether this trip cannot be used, due to operational delays and impossible transfers.
          type: boolean
          default: false
        
    TripLegStructure:  ## OJP
      description: >-
        A single stage of a trip that is made without change of MODE or service (ie: between each interchange).
      allOf:
        - oneOf:
            - $ref: "#/components/schemas/TimedLegStructure"
            - $ref: "#/components/schemas/TransferLegStructure"
            - $ref: "#/components/schemas/ContinuousLegStructure"
        - type: object
          properties:
            legId:
              description: Id of this trip leg. Unique within trip result.
              type: string
              format: uuid
            # participantRef:   # out of scope
            #   description: IT system that is participating in a communication with other participant(s)
            #   type: string

    TimedLegStructure:  ## OJP
      description: >-
        A passenger trip leg with timetabled schedule. Corresponds to a ride.
      type: object
      properties:
        timedLeg:
          $ref: "#/components/schemas/TimedLeg"
      required:
        - timedLeg

    GeneralAttribute:  ## OJP
      description: >-
        Structured attribute classification with associated text. If URL is given, it refers to the whole attribute text.
      type: object
      properties:
        text:
          description: Text of the attribute to be shown to the user.
          type: string
        code:
          description: Internal code of the attribute. Can be used for detection of double occurrences.
          type: string
        mandatory:
          description: Defines whether the attribute has to be shown to the user.
          type: boolean
        importance:
          description: Importance of the attribute.
          type: number
          minimum: 0
          maximum: 100
        url:
          description: URL to resource on web.
          type: string
          format: uri
        mimeType:
          description: MIME type of the referenced resource. To which kind of resource does the URL point to?
          type: string
        embeddable:
          description: >-
            Is the referenced resource meant to be embedded as a webview in a surrounding context, e.g. app 
            or web page? If yes, the resource has to be fully responsive.
          type: boolean
          default: false
      required:
        - text
        - code
        - url

    LegAttribute:  ## OJP
      description: >-
        Attributes that are not valid on the whole service, but only on section of a 
        trip made on a single mode without interchange between boarding and alighting (facilities 
        available on a specified (part of a) leg of a vehicle jouney)
      type: object
      allOf:
        - $ref: "#/components/schemas/GeneralAttribute"
        - type: object
          properties:
            fromStopSeqNumber:
              type: integer
              minimum: 1
            toStopSeqNumber:
              type: integer
              minimum: 1

    LinkProjection:  ## OJP
      description: >-
        An oriented correspondence from one link of a source layer, onto an entity in a target layer:
        e.g. link sequence.
      type: object
      properties:
        positions:
          type: array
          items:
            $ref: "#/components/schemas/LocationStructure"
          minItems: 2
      required:
        - position

    TrackSection:  ## OJP
      description: >-
        Link projection on the infrastructure network of the TRIP LEG together with time information.
      type: object
      properties:
        trackStart:
          $ref: "#/components/schemas/PlaceRef"
        trackEnd:
          $ref: "#/components/schemas/PlaceRef"
        lineProjection:
          $ref: "#/components/schemas/LinkProjection"
        roadName:
          type: string
          example: "Oude Trambaan"
        duration:
          type: string
          format: duration
          example: "3600S"
        length:
          type: number
          minimum: 0

    LegTrack:  ## OJP
      description: >-
        The link projection of a Leg onto the topography of the route being followed.
      type: object
      properties:
        trackSections:
          type: array
          items:
            $ref: "#/components/schemas/TrackSection"
          minItems: 1
      required:
        - trackSection

    TimedLeg:  ## OJP
      description: >-
        A leg which is bound to a timetabled schedule. Corresponds to a ride.
      required:
        - legAlight
        - legBoard
        - service
      type: object
      properties:
        legBoard:
          $ref: "#/components/schemas/LegBoard"
        legIntermediates:
          type: array
          items:
            $ref: "#/components/schemas/LegIntermediate"
        legAlight:
          $ref: "#/components/schemas/LegAlight"
        service:
          $ref: "#/components/schemas/DatedJourney"
        legAttribute:
          type: array
          items:
            $ref: "#/components/schemas/LegAttribute"
        operatingDays: # hack
          $ref: "#/components/schemas/OperatingDays"
        legTrack:
          type: array
          items:
            $ref: "#/components/schemas/LegTrack"

    TimeWindow:  ## OJP
      description: >-
        The window of opportunity that the traveller has to perform this leg of the journey.
      type: object
      properties:
        timeWindowStart:
          description: Time at which window begins.
          type: string
          format: date-time
        timeWindowEnd:
          description: Time at which window ends.
          type: string
          format: date-time

    PathLink:  ## OJP
      description: >-
        A link within a place of or between two places (that is stop places, access spaces or 
        quays, boarding positions, points of interest etc or path junctions) that represents 
        a step in a possible route for pedestrians, cyclists or other out-of-vehicle passengers
        within or between a place.
      type: object
      properties:
        transition:
          $ref: "#/components/schemas/TransitionEnumeration"
        accessFeatureType:
          $ref: "#/components/schemas/AccessFeatureTypeEnumeration"
        count:
          type: integer
          minimum: 1

    PathGuidanceSection:  ## OJP
      description: >-
        A description of a piece of a TRIP. May include geographic information, turn instructions
        and accessibility information.
      type: object
      properties:
        trackSection:
          description: LINK PROJECTION on the infrastructure network of the TRIP LEG together with time information
          $ref: "#/components/schemas/TrackSection"
        turnDescription:
          description: Textual description of a manoeuvre. This should imply the information from Manoeuvre, TurnAction, and TrackSection.RoadName.
          type: string
        guidanceAdvice:
          description: various types of guidance advice given to travel.
          $ref: "#/components/schemas/GuidanceAdviceEnumeration"
        turnAction:
          description: the range of alternative turns that can be described.
          $ref: "#/components/schemas/TurnActionEnumeration"
        directionHint:
          description: Textual direction hint for better understanding, e.g. "follow signs to Hamburg"...)
          type: string
        bearing:
          description: Absolute bearing after the described manoeuvre.
          type: number
          minimum: -360
          maximum: 360
        pathLink:
          description: Description of the type of accessibility on this navigation section.
          $ref: "#/components/schemas/PathLink"
        # Out of scope
        # situationFullRef:
        #   $ref: "#/components/schemas/SituationFullRef"

    PathGuidance:  ## OJP
      description: >-
        A description of a piece of a TRIP. May include geographic information, turn instructions 
        and accessibility information.
      type: object
      properties:
        pathGuidanceSections:
          type: array
          items:
            $ref: "#/components/schemas/PathGuidanceSection"
          minItems: 1
      required:
        - pathGuidanceSections

    TransferLegStructure:  ## OJP
      description: >-
        A leg which links other legs of a trip where a transfer between different locations is required.
      required:
        - legStart
        - legEnd
        - timeWindow
        - transferMode
      type: object
      properties:
        transferMode:
          $ref: "#/components/schemas/TransferMode"
        legStart:
          description: Stop/Station where boarding is done
          $ref: "#/components/schemas/PlaceRef"
        legEnd:
          description: Stop/Station to alight
          $ref: "#/components/schemas/PlaceRef"
        timeWindow:
          $ref: "#/components/schemas/TimeWindow"
        duration:
          description: Overall duration or this interchange.
          type: string
          format: duration
          example: "3600S"
        walkDuration:
          description: Walk time as part of the overall interchange duration.
          type: string
          format: duration
          example: "3600S"
        bufferTime:
          description: Buffer time as part of the overall interchange duration. Buffer times, f.e. check in/out times, sometimes are mandatory for using certain services as f.e. airplanes, ferries or highspeed trains.
          type: string
          format: duration
          example: "0S"
        legDescription:
          type: string
        length:
          type: number
          minimum: 0
        attribute:
          $ref: "#/components/schemas/GeneralAttribute"
        pathGuidance:
          $ref: "#/components/schemas/PathGuidance"
        # Out of scope
        # situationFullRef:
        #   $ref: "#/components/schemas/SituationFullRef"

    ContinuousLegStructure:  ## OJP
      description: >-
        A leg of a journey that is not bound to a timetable.
      required:
        - legStart
        - legEnd
        - service
        - timeWindow
        - transferMode
      type: object
      properties:
        legStart:
          description: Stop/Station where boarding is done
          $ref: "#/components/schemas/PlaceRef"
        legEnd:
          description: Stop/Station to alight
          $ref: "#/components/schemas/PlaceRef"
        service:
          $ref: "#/components/schemas/ContinuousService"
        timeWindow:
          description: Time window events should lie within. Starting from time given in PlaceContext.
          $ref: "#/components/schemas/TimeWindow"
        duration:
          description: >-
            Duration of this leg according to user preferences like walk speed.
          type: string
          format: duration
          example: "1800S"
        legDescription:
          type: string
        length:
          type: number
          minimum: 0
        pathGuidance:
          $ref: "#/components/schemas/PathGuidance"
        # Out of scope
        # situationFullRef:
        #   $ref: "#/components/schemas/SituationFullRef"

    ContinuousService:  ## OJP
      description: >-
        A vehicle movement on a continuous, non-timetabled service.
        Service of this leg. May be "walk" in most cases, but also cycling or taxi etc.
      type: object
      required:
        - operatingDayRef
        - journeyRef
        - mode
        - publishedServiceName
        - originText
        - destinationText
      properties:
        continuousMode: # FIXME: should be one of
          $ref: "#/components/schemas/ContinuousMode"
        individualMode: # FIXME: should be one of
          $ref: "#/components/schemas/IndividualMode"
        operatingDayRef:
          $ref: "#/components/schemas/OperationDayRef"
        journeyRef:
          $ref: "#/components/schemas/JourneyRef"
        mode: # Ask Stefan
          type: string
          example: "Ask Stefan"
        publishedServiceName:
          type: string
          example: "Circle Line"
        originText:
          type: string
        destinationText:
          type: string

    ContinuousMode:  ## OJP
      description: Types of modes that run at any time without a timetable.
      type: string
      enum:
        - WALK
        - DEMAND_RESPONSIVE
        - REPLACEMENT_SERVICE
      default: WALK
    
    IndividualMode:  ## OJP
      description: Modes which an individual powers themselves (such as walk, cycle).
      type: string
      enum:
        - WALK 
        - CYCLE
        - TAXI
        - SELF_DRIVE_CAR
        - OTHERS_DRIVE_CAR
        - MOTORCYCLE
        - TRUCK
        - SCOOTER
        - RIDE_POOL_CAR
        - CAR_SHARING
        - CYCLE_SHARING
        - SCOOTER_SHARING
      default: WALK
      
    TransferMode:  ## OJP
      description: Modes dedicated to perform transfers.
      type: string
      enum:
        - WALK
        - PARK_AND_RIDE
        - BIKE_AND_RIDE
        - CAR_HIRE
        - BIKE_HIRE
        - PROTECTED_CONNECTION
        - GUARANTEED_CONNECTION
        - REMAIN_IN_VEHICLE
        - CHANGE_WITHIN_VEHICLE
        - CHECK_IN
        - CHECK_OUT
      default: WALK

    TurnActionEnumeration:  ## OJP
      description: the range of alternative turns that can be described
      type: string
      enum:
        - SHARP_LEFT
        - LEFT
        - HALF_LEFT
        - STRAIGHT_ON
        - HALF_RIGHT
        - RIGHT
        - SHARP_RIGHT
        - UTURN

    GuidanceAdviceEnumeration:  ## OJP
      description: various types of guidance advice given to travel
      type: string
      enum:
        - ORIGIN
        - DESTINATION
        - CONTINUE
        - KEEP
        - TURN
        - LEAVE
        - ENTER

    TypeOfFareClassEnumeration:  ## OJP
      description: classes of travel available on a particular service which will affect the price to be paid
      type: string
      enum:
        - ALL
        - FIRST
        - SECOND
        - THIRD
        - BUSINESS
        - ECONOMY

    TransitionEnumeration:  ## OJP
      description: Transition types for interchanges.
      type: string
      enum:
        - UP
        - DOWN
        - LEVEL
        - UP_AND_DOWN
        - DOWN_AND_UP

    AccessFeatureTypeEnumeration:  ## OJP
      description: Allowed values for a AccessFeature.
      type: string
      enum:
        - LIFT
        - STAIRS
        - SERIES_OF_STAIRS
        - ESCALATOR
        - RAMP
        - FOOTPATH

    PassengerCategoryEnumeration:  ## OJP
      description: classification of passengers by age or other factors that may determine the fare they will need to pay.
      type: string
      enum:
        - ADULT
        - CHILD
        - SENIOR
        - YOUTH
        - DISABLED

    PrivateModesEnumeration:  ## OJP
      description: modes offered by private individuals
      type: string
      enum:
        - CAR_POOLING

    VehicleModesOfTransportEnumeration:  ## OJP  # TODO: Clarify description
      description: Vehicle mode- Tpeg ModeType pti1.
      type: string
      enum:
        - UNKNOWN
        - RAILWAY_SERVICE
        - RAIL
        - COACH_SERVICE
        - COACH
        - SUBURBAN_RAILWAY_SERVICE
        - SUBURBAN_RAIL
        - URBAN_RAILWAY_SERVICE
        - URBAN_RAILWAY
        - METRO_SERVICE
        - METRO
        - UNDERGROUND_SERVICE
        - UNDERGROUND
        - BUS_SERVICE
        - BUS
        - TROLLEY_BUS_SERVICE
        - TROLLEY_BUS
        - TRAM_SERVICE
        - TRAM
        - WATER_TRANSPORT_SERVICE
        - WATER_TRANSPORT
        - AIR_SERVICE
        - AIR
        - FERRY_SERVICE
        - WATER
        - TELECABIN_SERVICE
        - TELECABIN
        - FUNICULAR_SERVICE
        - FUNICULAR
        - TAXI_SERVICE
        - TAXI
        - SELF_DRIVE
        - ALL_SERVICES
        - ALL
        - ALL_SERVICES_EXCEPT

    StopCallStatus:  ## OJP
      description: Status properties for the vehicle call at this stop.
      type: object
      properties:
        order:
          description: Sequence number of this stop in the service pattern of the journey.
          type: integer
          minimum: 1
        requestStop:
          description: The vehicle journey calls at this stop only on demand.
          type: boolean
          default: false
        unplannedStop:
          description: This stop has not been planned by the planning department.
          type: boolean
          default: false
        notServicedStop:
          description: The vehicle will not call at this stop despite earlier planning.
          type: boolean
          default: false
        noBoardingAtStop:
          description: Boarding will not be allowed at this stop of this journey.
          type: boolean
          default: false
        noAlightingAtStop:
          description: Alighting will not be allowed at this stop of this journey.
          type: boolean
          default: false
        
    LegBoard:  ## OJP
      description: Stop/Station where boarding is done.
      allOf:
        - type: object
          required:
            - stopPointRef
            - stopPointName
            - serviceDeparture  
          properties:
            stopPointRef:
              $ref: "#/components/schemas/StopPointRef"
            stopPointName:
              type: string
              example: Zug
            nameSuffix:
              description: >-
                Additional description of the stop point that may be appended to the 
                name if enough space is available. F.e. "opposite main entrance".
              type: string
            plannedQuay:
              description: >-
                Name of the bay where to board the vehicle. According to planned timetable.
              type: string
              example: "4"
            estimatedQuay:
              description: >-
                Name of the bay where to board the vehicle. As to the latest realtime status.
              type: string
              example: "8"
            serviceDeparture:
              $ref: "#/components/schemas/ServiceDeparture"
        - $ref: "#/components/schemas/StopCallStatus"

    LegIntermediate:  ## OJP
      description: >-
        Describes the situation at a stop or station that lies between the
        LegBoard and LegAlight stop or station including time-related information.
      allOf:
        - type: object
          required:
            - order
            - plannedQuay
            - serviceArrival
            - stopPointName
            - stopPointRef
          properties:
            stopPointRef:
              $ref: "#/components/schemas/StopPointRef"
            stopPointName:
              type: string
              example: Luzern
            plannedQuay:
              description: >-
                Name of the bay where to board/alight from the vehicle. According to 
                planned timetable.
              type: string
              example: "3"
            serviceArrival:
              $ref: "#/components/schemas/ServiceArrival"
            serviceDeparture:
              $ref: "#/components/schemas/ServiceDeparture"
        - $ref: "#/components/schemas/StopCallStatus"

    LegAlight:  ## OJP
      description: >-
        Describes the situation at a stop or station at which the passenger alights
        from a Leg of a trip including time-related information.
      allOf:
        - type: object
          required:
            - serviceArrival
            - stopPointName
            - stopPointRef      
          properties:
            stopPointRef:
              $ref: "#/components/schemas/StopPointRef"
            stopPointName:
              type: string
              example: Luzern
            nameSuffix:
              description: >-
                Additional description of the stop point that may be appended to the 
                name if enough space is available. F.e. "opposite main entrance".
              type: string
            plannedQuay:
              description: >-
                Name of the bay where to alight from the vehicle. According to planned timetable.
              type: string
              example: "3"
            estimatedQuay:
              description: >-
                Name of the bay where to alight from the vehicle. As to the latest realtime status.
              type: string
              example: "8"
            serviceArrival:
              $ref: "#/components/schemas/ServiceArrival"
        - $ref: "#/components/schemas/StopCallStatus"

    ServiceArrival:  ## OJP
      description: >-
        Describes the departure situation at this leg board stop point (group of attributes
        of timetabled passing time, estimated passing time, observed passing time).
      allOf:
        - $ref: "#/components/schemas/ServiceTime"  
        # - $ref: "#/components/schemas/EstimatedTimeBand"   #Out of scope

    ServiceDeparture:  ## OJP
      description: >-
        Describes the departure situation at this leg board stop point (group of attributes
        of timetabled passing time, estimated passing time, observed passing time).
      allOf:
        - $ref: "#/components/schemas/ServiceTime"
        # - $ref: "#/components/schemas/EstimatedTimeBand"   #Out of scope

    ServiceTime:  ## OJP
      description: >-
        Contains at least scheduled time, but can contain real time and estimated times.
      type: object
      required:
        - timetabledTime
      properties:
        timetabledTime:
          type: string
          format: date-time
        estimatedTime:
          type: string
          format: date-time
        observedTime:
          type: string
          format: date-time

    DatedJourney:  ## OJP
      description: >-
        Vehicle journey that runs at a specific date.
      required:
        - operatingDayRef
        - journeyRef
        - mode
        - publishedServiceName
      type: object
      properties:
        ### Other attributes are out of scope
        operatingDayRef:
          $ref: "#/components/schemas/OperationDayRef"
        journeyRef:
          $ref: "#/components/schemas/JourneyRef"
        mode:
          $ref: "#/components/schemas/Mode"
        productCategory:
          $ref: "#/components/schemas/ProductCategory"
        publishedServiceName:
          description: >-
            Line name or service description as known to the public, f.e. "512", "S8"
            or "Circle Line" or "ICE 488".
          type: string
          example: S1
        trainNumber:
          description: >-
            If several TrainNumber types exist, use the commercial number.
          type: string
          example: 1
        operatorRef:
          description: Reference to transport operator
          type: string
          example: ojp:11

    Mode:  ## OJP
      description: A method of transportation such as bus, rail, etc.
      required:
        - ptMode
      type: object
      properties:
        # Out of Scope
        # ptMode:
        #   $ref: "#/components/schemas/PTModeChoiceGroup"
        name:
          description: Name of the mode
          type: string
          example: rail
        shortName:
          description: Short name or acronym of the mode
          type: string
          example: S
        description:
          description: Additional text that further describes the mode
          type: string

    ProductCategory:  ## OJP
      description: >-
        Product category based on NeTEx/SIRI. A product category is a classification for VEHICLE JOURNEYs
        to express some common properties of journeys for marketing and fare products.
      required:
        - name
        - shortName
        - productCategoryRef
      properties:
        name:
          description: >-
            Full name of this product category, e.g. "Autoreisezug" in Switzerland or "Train Grand Vitessee".
          type: string
          example: Autoreisezug
        shortName:
          description: >-
            Short name or acronym of the product category, likely to be published, e.g. "ARZ", "TGV"
          type: string
          example: ARZ
        productCategoryRef:
          $ref: "#/components/schemas/ProductCategoryRef"

    Place:  ## OJP
      description: 
        A geographic place of any type which may be specified as the origin or destination of a trip.
      allOf:
      - oneOf:
        - $ref: "#/components/schemas/AddressStructure"
        - $ref: "#/components/schemas/PointOfInterestStructure"
        - $ref: "#/components/schemas/StopPlaceStructure"
        - $ref: "#/components/schemas/StopPointStructure"
        - $ref: "#/components/schemas/TopographicPlaceStructure"
      - $ref: "#/components/schemas/GeoPositionStructure"
      - type: object
        properties:
          name:
            type: string
            example: Zürich HB
          attribute:
           $ref: "#/components/schemas/GeneralAttribute"
        #  extension:   # Out of scope
        #   $ref: "#/components/schemas/Extension"

    AddressStructure: ## OJP
      type: object
      properties:
        address:
          $ref: "#/components/schemas/Address"
      required:
        - address

    Address:  ## OJP
      description: >-
        A descriptive data associated with a place that can be used to describe the unique geographical context of a
        place for the purposes of identifying it. may be refined as either a road address, a postal address or both.
      allOf:
      - type: object
        required:
          - addressCode
          - addressName
        properties:
          addressCode:
            description: ID of this address.
            type: string
            example: NL:1916200000022621
          privateCode:
            description: Code of this address in private/foreign/proprietary coding schemes.
            $ref: "#/components/schemas/PrivateCode"
          addressName:
            description: Name or description of address for use in passenger information.
            type: string
            example: Oude Trambaan 7, 2265CA Leidschendam, Nederland
          nameSuffix:
            description: House number of the address. If none is given, either a crossing street can be given, or the whole street is meant.
            type: string
      - $ref: "#/components/schemas/AddressDetail"

    AddressDetail:  ## OJP
      description: An address with its name entities
      type: object
      properties:
        countryName:
          description: "Country of the address."
          type: string
          example: The Netherlands
        postCode:
          description: "Postal code of the address."
          type: string
          example: 2265CA
        topographicPlaceName:
          description: "TopographicPlace name of the address. If set it should at least contain the city name."
          type: string
          example: Leidschendam
        topographicPlaceRef:
          description: If at least one is set, only place objects within the given localities are allowed.If at least one is set, only place objects within the given localities are allowed.Reference to a TopographicPlace
          $ref: "#/components/schemas/TopographicPlaceRef"
        street:
          description: Street name of the address.
          type: string
          example: Oude Trambaan
        houseNumber:
          description: House number of the address. If none is given, either a crossing street can be given, or the whole street is meant.
          type: string
          example: 7
        crossRoad:
          description: Crossing. This can be used to be more specific without using house numbers.
          type: string

    PointOfInterestStructure:  ## OJP
      type: object
      properties:
        pointOfInterest:
          $ref: "#/components/schemas/PointOfInterest"
      required:
        - pointOfInterest

    PointOfInterest:  ## OJP
      description: >-
        A type of place to or through which passengers may wish to navigate as part of
        their journey and which is modelled in detail by journey planners.
      type: object
      required:
        - pointOfInterestCode
        - pointOfInterestName
      properties:
        pointOfInterestCode:
          description: ID of this Point of Interest.
          type: string
        pointOfInterestName:
          description: Name or description of point of interest for use in passenger information.
          type: string
          example: Park Rozenrust
        nameSuffix:
          description: >-
            Additional description of the point of interest that may be appended to the name if enough space 
            is available. F.e. "Exhibition Center".
          type: string
        pointOfInterestCategory:          
          description: Categories this POI is associated with. Order indicates descending relevance.
          $ref: "#/components/schemas/PointOfInterestCategory"
        privateCode:
          description: Code of this address in private/foreign/proprietary coding schemes.
          $ref: "#/components/schemas/PrivateCode"
        topographicPlaceRef:
          description: >-
            If at least one is set, only place objects within the given localities are allowed. If at least one is set,
            only place objects within the given localities are allowed. Reference to a TopographicPlace.
          $ref: "#/components/schemas/TopographicPlaceRef"

    PointOfInterestCategory:  ## OJP
      description: >-
        A categorisation of POINTs OF INTEREST in respect of the activities undertaken at them (defined by key-value-pairs).
      oneOf:
        - type: object
          description: Open Street Map tag structure (key-value)
          properties:
            osmTags:
              type: array
              items:
                $ref: "#/components/schemas/OsmTagStructure"
          required:
            - osmTag
        - type: object
          properties:
            pointOfInterestClassifications:
              description: Classification of the POI (when it is not from OSM). The codification of the classification Id may include de codification source (for example "IGN:[classificationCode]")
              type: array
              items:
                type: string
          required:
            - pointOfInterestClassification

    OsmTagStructure:  ## OJP
      description: Structure of an Open Street Map tag.
      type: object
      properties:
        tag:
          type: string
          description: Name of Open Street Map tag (amenity, leisure, tourism, bike, ...)
          example: name
        value:
          type: string
          description: Value for Open Street Map tag (charging_station, hostel, yes, ...)
          example: Rozenrust
      required:
        - tag
        - value

    StopPlaceStructure:  ## OJP
      type: object
      properties:
        stopPlace:
          $ref: "#/components/schemas/StopPlace"
      required:
        - stopPlace

    StopPlace:  ## OJP
      description: >-
        A PLACE extended by ACCESSIBILITY LIMITATION properties and some attributes of the associated equipment, comprising one
        or more locations where vehicles may stop and where passengers may board or leave vehicles or prepare their trip, and which 
        will usually have one or more wellknown names
      allOf:
        - type: object
          required:
            - stopPlaceName
            - stopPlaceRef
          properties:
            stopPlaceRef:
              description: Reference to a Stop Place
              $ref: "#/components/schemas/StopPlaceRef"
            stopPlaceName:
              description: Name of this stop place for use in passenger information.
              type: string
              example: Zürich HB
            nameSuffix:
              description: Additional description of the stop place that may be appended to the name if enough space is available.
              type: string
              example: Exhibition Center
            privateCode:
              description: Code of this stop place in private/foreign/proprietary coding schemes.
              $ref: "#/components/schemas/PrivateCode"
            topographicPlaceRef:
              description: If at least one is set, only place objects within the given localities are allowed.If at least one is set, only place objects within the given localities are allowed.Reference to a TopographicPlace
              $ref: "#/components/schemas/TopographicPlaceRef"
        - $ref: "#/components/schemas/StopAttributes"

    StopAttributes:  ## OJP
      description: >-
        A selection of attributes of accessibiity limitation related to a scheduled stop point extended by attributes
        referring to some equipment.
      type: object
      properties:
        wheelchairAccessible:
          description: Whether this stop is accessible for wheelchair users.
          type: boolean
        lighting:
          description: Whether this stop is lit.
          type: boolean
        covered:
          description: Whether this stop offers protection from weather conditions like rain, snow, storm etc.
          type: boolean

    AreaStructure:  ## OJP
      description: Area described as a polygon.
      type: object
      properties:
        points:
          type: array
          items:
            $ref: "#/components/schemas/LocationStructure"

    TopographicPlaceStructure:  ## OJP
      type: object
      properties:
        toppographicPlace:
          $ref: "#/components/schemas/TopographicPlace"
      required:
        - topographicPlace

    TopographicPlace:  ## OJP
      description: >-
        a type of place providing the topographical context when searching for or presenting travel information, 
        for example as the origin or destination of a trip. it may be of any size (e.g. county,city, town, village) 
        and of different specificity (e.g. greater london, london, west end, westminster, st james's).
      type: object
      properties:
        topographicPlaceCode:
          type: string
        topographicPlaceName:
          type: string
        privateCode:
          $ref:  "#/components/schemas/PrivateCode"
        parentRef:
          $ref:  "#/components/schemas/TopographicPlaceRef"
        referredSystemId:
          type: string
        area:
          $ref:  "#/components/schemas/AreaStructure"
      required:
        - topographicPlaceCode
        - topographicPlaceName

    StopPointStructure:  ## OJP
      type: object
      properties:
        stopPoint:
          $ref: "#/components/schemas/StopPoint"
      required:
        - stopPoint

    StopPoint:  ## OJP
      description: >-
        An extended view of scheduled stop point in tmv6 a scheduled stop point extended by accessibility limitation
        attributes and with identifier and name where passengers can board or alight from vehicles.
      allOf:
        - type: object
          required:
            - stopPlaceRef
            - stopPointName
          properties:
            stopPointRef:
              $ref: "#/components/schemas/StopPointRef"
            stopPointName:
              description: Name or description of stop point for use in passenger information.
              type: string
            nameSuffix:
              description: Additional description of the stop point that may be appended to the name if enough space is available.
              example: opposite main entrance
              type: string
            plannedQuay:
              description: Name of the bay where to board/alight from the vehicle. According to planned timetable.
              type: string
            estimatedQuay:
              description: Name of the bay where to board/alight from the vehicle. As to the latest realtime status.
              type: string
            privateCode:
              description: Code of this stop point in private/foreign/proprietary coding schemes.
              $ref: "#/components/schemas/PrivateCode"
            parentRef:
              description: Reference to the stop place to which this stop point belongs.
              $ref: "#/components/schemas/StopPlaceRef"
            topographicPlaceRef:
              description: If at least one is set, only place objects within the given localities are allowed.If at least one is set, only place objects within the given localities are allowed.Reference to a TopographicPlace
              $ref: "#/components/schemas/TopographicPlaceRef"
        - $ref: "#/components/schemas/StopAttributes"

    PrivateCode:  ## OJP
      description: Code of this stop point in private/foreign/proprietary coding schemes.
      type: object
      properties:
        system:
          type: string
          example: EFA
        value:
          type: string
          example: "6373080"
      required:
        - system
        - value

    LocationStructure:  ## OJP
      description: WGS84 coordinates position
      type: object
      properties:
        longitude:
          $ref: "#/components/schemas/Longitude"
        latitude:
          $ref: "#/components/schemas/Latitude"
        altitude:
          $ref: "#/components/schemas/Altitude"
        precision:
          $ref: "#/components/schemas/Precision"
      required:
        - latitude
        - longitude

    Longitude:  ## OJP
      description: Longitude from Greenwich Meridian. -180 (West) to +180 (East). Decimal degrees. eg 2.356
      type: number
      format: float
      example: 8.54021
      minimum: -180.0
      maximum: 180.0

    Latitude:  ## OJP
      description: Latitude from equator. -90 (South) to +90 (North). Decimal degrees. eg 56.356
      type: number
      format: float
      example: 47.37818
      minimum: -90.0
      maximum: 90.0

    Altitude:  ## OJP
      description: Altitude metres from sea level.
      type: number
      format: float
      example: 0.0

    Precision:  ## OJP
      description: Precision for point measurement. In Meters.
      type: number
      format: float
      example: 0.0

    StopPointRef:  ## OJP
      description: Reference to a (SCHEDULED) STOP POINT
      type: string
      example: "8503000"

    StopPlaceRef:  ## OJP
      description: Reference to a Stop Place
      type: string
      example: "8503000"

    PointOfInterestRef:  ## OJP
      description: Reference to a Point of Interest
      type: string
      example: "8503000"

    AddressRef:  ## OJP
      description: Reference to an Address
      type: string
      example: "1234567"

    TopographicPlaceRef:  ## OJP
      description: Reference to a TopographicPlace
      type: string
      example: Leidschendam

    ProductCategoryRef:  ## OJP
      description: >-
        A reference to the product category. This is the internal code used within the reference frameworks (NeTEx, SIRI). 
        It is usually not displayed, but interpreted by the technical system, e.g. "ch:1:TypeOfProductCategory:ARZ" 
        (Autoreisezug in Switzerland) or "ch:1:TypeOfProductCategory:BAV".
      type: string
      example: "ch:1:TypeOfProductCategory:ARZ"

    OperationDayRef:  ## OJP
      description: Reference to an operating day
      type: string
      example: "OperatingDay:12345"

    JourneyRef:  ## OJP
      description: Reference to a journey
      type: string
      example: "ServiceJourney:1"

    OfferSearchCriteria:
      type: object
      properties:
        flexibilities:
          description: >-
            Defines the flexibility levels desired of the fares returned.
            This refers to the after sales flexibility levels as defined in IRS-90918-10
          type: array
          items:
            $ref: '#/components/schemas/Flexibility'
        comfortClasses:
          type: array
          items:
            $ref: '#/components/schemas/ComfortClass'
          description: >-
            The classes returned might be different from the requested classes.
        serviceClassIds:
          type: array
          items:
            $ref: '#/components/schemas/ServiceClassType'
          description: >-
            The classes returned might be different from the requested classes.
        requestedOfferParts:
          type: array
          items: 
            $ref: '#/components/schemas/OfferPartType'
        currency:
          $ref: '#/components/schemas/Currency'
          description:
            The currency returned might be different from the one requested.

    OfferPartType:
      type: string
      enum:
        - ADMISSION
        - RESERVATION
        - ANCILLARY
        - FARE_ADMISSION
        - FARE_RESERVATION
        - FARE_ANCILLARY
        - ALL
      default:
        - ALL
      description: >-
        Allows to request offerparts of a certain type. 
        To support H/H use ["RESERVATION", "ANCILLARY"].
        Default is to get search for offers of all types.

    NonTripOfferSearchCriteria:
      type: object
      properties:
        freeText:
          type: string
          description: >- 
            Allows the API consumer to provide a free-text based search. Usage of the provided tewt in the search process is left to the OSDM provider but should be documented
        flexibilities:
          description: >-
            Defines the flexibility levels desired of the fares returned.
            This refers to the after sales flexibility levels as defined in IRS-90918-10
          type: array
          items:
            $ref: '#/components/schemas/Flexibility'
        comfortClasses:
          type: array
          items:
            $ref: '#/components/schemas/ComfortClass'
          description: >-
            The classes returned might be different from the requested classes.
        serviceClassTypes:
          type: array
          items:
            $ref: '#/components/schemas/ServiceClassType'
          description: >-
            The classes returned might be different from the requested classes.
        currency:
          $ref: '#/components/schemas/Currency'
          description:
            The currency returned might be different from the one requested.

    TripOfferRequest:
      type: object      
      description: >-
        Defines the parameters needed to request an offer. 
      properties:
        tripSearchCriteria:
          $ref: '#/components/schemas/TripRequest'      
        returnSearchParameters:
          type: object
          description: >-
            This property can be used in case a return trip is being requested. 
            This will allow to benefit from return-specific fares or product
          properties:
            inwardReturnDate:
              type: string
              format: date-time
              description: >-
                Needs to be provided when creating the collection of outward travels so that the
                provider knows when a return travel can be expected and propose appropriate
                product and fares.
            outwardTripOfferCollectionId: 
               type: string
               format: uuid
               description: >-
                 Needs to be provided when creating the collection of inward travels so that the provider
                 can relate the inward travels to the outward travels context.
            outwardSelectedOfferTag:
               type: string
               description: >-
                 Needs to be provided when creating the collection of inward travels so that the provider
                 knows what the outward offer is and and propose compatible offers only if desired or mandatory.
        requestedFulfillmentOptions:
          type: array
          items:
            $ref: '#/components/schemas/FulfillmentOption'
        passengers:
          type: array
          items:
            $ref: '#/components/schemas/Passenger'
        offerSearchCriteria:
          $ref: '#/components/schemas/OfferSearchCriteria'
        embed:
          description: >-
            Influences whether referenced resources are returned in full or as references only.
          type: array
          items:
            type: string
            enum:
              - ALL
              - TRIPOFFERS
              - TRIPOFFERS.TRIP
              - TRIPOFFERS.TRIP.LOCATIONS
              - TRIPOFFERS.OFFERS
              - TRIPOFFERS.OFFERS.OFFERPARTS
              - TRIPOFFERS.PASSENGERS
              - NONE
          default: [ALL]
      required:
        - tripSearch
        - passengers

    TripOffer:
      type: object
      properties:
        id:
          type: string
        abstract:
          type: string
          example: Bruxelles-Midi 2020-07-01 10:05 CET
        trip:
          $ref: '#/components/schemas/Trip'
        tripKey:
          description: >-
            client reference that could be received in a search with trips in input. In such cases it is expected to be echoed back.          
          type: string
        offers:
          type: array
          items:
            $ref: '#/components/schemas/Offer'
        passengers:
          type: array
          items:
            $ref: '#/components/schemas/Passenger'
        links:
          type: array
          items:
            $ref: '#/components/schemas/Link'
      required: 
        - id
        - trip

    RequestedInformation:
      type: string
      description: >-
        Boolean-expression indicating the data that must be set in the data
        model in order to proceed to next step of the process.
        
    OfferSummary:
      type: object
      description: >-
        The offer summary indicates the major service class, level or flexibility.
        This does not imply that this service class or level applies to all parts 
        of the whole offer. 
      properties:
        minimalPrice:
          $ref: '#/components/schemas/Price'
        overallServiceClass:
          $ref: '#/components/schemas/ServiceClass'
        overallComfortClass:
          $ref: '#/components/schemas/ComfortClass'
        overallAccommodationType:
          $ref: '#/components/schemas/AccommodationType'
        overallAccommodationSubType:
          $ref: '#/components/schemas/AccommodationSubType'          
        overallFlexibility:
          $ref: '#/components/schemas/Flexibility'
      required:
        - minimalPrice
        - overallServiceClass
        - overallFlexibility

    Offer:
      type: object
      properties:
        id:
          type: string
        abstract:
          type: string
          example: Bruxelles-Midi - Paris-Nord 2020-07-01 10:05 CET, Normal Fare, 50 EUR
        offerSummary:
          $ref: '#/components/schemas/OfferSummary'
        isReusable:
          type: boolean
          default: false
          description: >-
            Indicates whether the offerId can be used in more than one booking.
        offerTag:
          type: object
          properties:
            isMandatory:
              type: boolean
              default: false
            offerTag:
              type: string
          description: >-
            The offerTag can/must (depending on the mandatory flag) be used in some cases to restrict the set of
            offers returned in a subsequent and related offer search to only compatible ones.
            Note the offerTag does not need to be unique.
        coveredSegmentIndexes:
          type: array
          items:
            type: integer
            format: int32
          description: >-
            relevant only in case the offer only covers parts of the trip. This will indicate which segments are covered by the specific offer
        returnTags:
          type: array
          items:
            type: string
          description: >-
            List of tags (and their type) that allow identifying sets of compatible offers when booking a return trip
            involving return-specific fares. All returnTags must be present in the counterpart offer to allow combination
            If no tag is provided, there is no return constraint on this specific offer.
        tripTags:
          type: array
          items:
            type: string
          description: >-
            List of tags (and their type) that allow identifying sets of compatible offers when trying to combine multiple offers covering one single trip. 
            At least one (not all) tripTags must be in common to allow combination
            If no tag is provided, there is no trip constraint on this specific offer.
        appliedThroughTicketTags:
          type: array
          items:
            type: string
          description: >-
            the list of all throughticket tags that were effectively used in building or booking the offer.
            Cross-checking this list with the products, the actual groupings applied can be identified.
        requestedInformation:
          $ref: '#/components/schemas/RequestedInformation'
        availableFulfillmentTypes:
          type: array
          items:
            $ref: '#/components/schemas/FulfillmentType'
        trip:
          $ref: '#/components/schemas/Trip'
          description: >-
            Note that trip element cannot be embedded in tripoffer context as the
            TRIPOFFERS.OFFERS.TRIP value is not a possible embed value for TripOffers.
        validFrom:
          type: string
          format: date-time
          description: >-
            Defines the minimum validity period of the trip booked, meaning the period 
            during which it will be possible to travel with the fulfillments for this offer.
        validUntil:
          type: string
          format: date-time 
          description: >-
            Defines the minimum validity period of the trip booked, meaning the period 
            during which it will be possible to travel with the fulfillments for this offer.
        admissions:
          type: array        
          items: 
            $ref: '#/components/schemas/Admission'
        reservations:
          type: array        
          items:              
            $ref: '#/components/schemas/Reservation'
        ancillaries:
          type: array        
          items:  
            $ref: '#/components/schemas/Ancillary'
        fees:
          type: array
          items:
            $ref: '#/components/schemas/Fee'
        fares:
          type: array
          items:
            $ref: '#/components/schemas/FareOnline'
        links:
          type: array
          items:
            $ref: '#/components/schemas/Link'
      required:
        - id

    ComfortClass:
      description: >-
        Generic class classification, mostly used to harmonize choice and
        representation across multiple carriers.
      type: string
      x-extensible-enum:
        - FIRST
        - SECOND 
      

    Flexibility:
      type: string
      x-extensible-enum:
        - FULLFLEX
        - MIDFLEX
        - NONFLEX

    CommonOfferPartAttributes:
      type: object
      properties:
        price:
          $ref: '#/components/schemas/Price'
        pricingMode:
          type: string
          enum:
            - COLLECTIVE
            - INDIVIDUAL 
          default: INDIVIDUAL
        reductionsApplied:
          type: array
          items:
            $ref: '#/components/schemas/CardReference'
        passengers:
          type: array
          items:
            $ref: '#/components/schemas/Passenger'
        providerBookingReference:
          type: string
          description: >-
            The booking reference of the booking the offer part is in on the provider side.
        finalProviderBookingReference:
          type: string
          description: >-
            The booking reference of the order the offer part is in on the final provider 
            side = the provider actually hosting or allocating  the product.
        availableFulfillmentOptions:
          type: array
          items:
            $ref: '#/components/schemas/FulfillmentOption'
        validFrom:
          type: string
          format: date-time
          description: >-
            Validity of offer towards passenger 
        validUntil:
          type: string
          format: date-time
          description: >-
            Validity of offer towards passenger
        numericAvailability:
          type: integer
          format: int32
          description: >-
            If supported by the allocator system, this returns the number of remaining available
            offerparts, i.e. admissions, reservation or ancillaries.
        refundable:
          type: string
          enum:
            - YES
            - NO
            - WITH_CONDITIONS
        exchangeable:
          type: string
          enum:
            - YES
            - NO
            - WITH_CONDITIONS
        products:
          type: array
          items:
            type: object
            properties:
              product:
                $ref: '#/components/schemas/Product'
              segmentIndices:
                description: indices of the segments in the trip given by the provider of the offer
                type: array
                items:
                  type: integer
                  format: int32
      required:
        - price
        - passengers
        - validFrom
        - refundable
        - exchangeable
            
    Product:
      type: object
      description: >-
         Structured description of the product , its name, comfort and sales / after-sales conditions
      properties:
        id:
          type: string
          description: unique id of this product on this server.
        abstract:
          type: string
          example: TGV Lyria Loisir 2
        code:
          type: string
          description: >-
            The product code expressed in the provider system (could be a
            mapping from an even lower-level provider).
          example: PT00AD
        description:
          type: string
          description: the textual description of the product
          example: Loisir Non-flex Adult Fare
        conditions:
          type: array
          items:
            $ref: '#/components/schemas/Condition'
          description: >-
            Structured description of the sales or after-sales conditions.
        serviceClass:
          $ref: '#/components/schemas/ServiceClass'
        comfortClass:
          $ref: '#/components/schemas/ComfortClass'
        isTrainBound:
          type: boolean
          default: false
        isReturnProduct:
          type: boolean
          default: false
        fulfillmentOptions:
          type: array
          items:
            $ref: '#/components/schemas/FulfillmentOption'
        serviceConstraintText:
          type: string
        carrierConstraintText:
          type: string
        throughTicketTags:
          type: array
          items:
            type: string
          description: >-
            List of tags (and their type) that allow identifying sets of offers for which related contracts can be grouped into one through ticket
        combinationTags:
          description: >-
            Tags to indicate that some products from a provider can be sold only when in conjunction with product(s) 
            from another provider using the same tag. At least one, not all, combinationTags must be in common to allow 
            combination. No combinationTags indicate that there are no combination constraints on the product.        
          type: array
          items:
            type: object
            properties:
              combinationTag:
                type: string
              needsToBeCombined:
                description: >-
                  If false it means that this product can only be sold also when not in conjunction with a product with
                  the same tag. This is needed to propose specific products from one provider that depend on public ones of 
                  another.
                type: boolean
                default: false
        links:
          type: array
          items:
            $ref: '#/components/schemas/Link'
      required:
        - id

    FulfillmentMediaType:
       type: string
       description: >-
         Fulfillment types. RCT2, RCCST and UIC-PDF are official UIC standards.     
       x-extensible-enum:
         - RCT2
         - RCCST
         - UIC_PDF
         - PDF_A4
         - PKPASS
         - TICKETLESS
    
    Admission:
      type: object
      description:
        An admission represents a travel right, or the entitlement to travel onboard a train between 
        the given origin and destination, following the given route. It does not include a seat reservation. 
      properties:
        id:
          type: string
        commonOfferPartAttributes:
          $ref: '#/components/schemas/CommonOfferPartAttributes'
        isReservationRequired:
          type: boolean
        reservations:
          type: array
          items:
            $ref: '#/components/schemas/OfferPartReference'
        ancillaries:
          type: array
          items:
            type: object
            properties:
              relationType:
                type: string
                x-extensible-enum:
                  - OPTIONAL
                  - INCLUDED
              ancillary:
                $ref: '#/components/schemas/OfferPartReference'
        fees:
          type: array
          items:
            $ref: '#/components/schemas/OfferPartReference'
      required:
        - id
        - commonOfferPartAttributes
                
    PlaceSelectionPatch:
      type: object
      description: >-
        place selection options and selected options in an offer
        - selected optional place properties (selectedOptions)
        - selectedPlaces from a graphical place selection (selectedPlaces)
        - reference place for adjacent reservation (referencePlace)
      properties:
        referencePlace: 
          type: object    
          description: selected place for an adjacent reservation (NEARBY)
          properties:
            placeNumber:
              type: string
            coachNumber:
              type: string
        selectedOptions:
          type: array
          items: 
            $ref: '#/components/schemas/PlaceOptionsBundle'
        selectedCoach:
          $ref: '#/components/schemas/SelectedCoach'
    
    Reservation:
      type: object
      description: >-
        Reservation includes the reference to the in the initial offer. 
        The offer needs to be updated with the selected places before the confirmation
        which creates the reservation details including the reserved places.
      properties:
        id:
          type: string
        commonOfferPartAttributes:
          $ref: '#/components/schemas/CommonOfferPartAttributes'
        reservationDetails:
          $ref: '#/components/schemas/ReservationDetail'
        placeSelection:
          $ref: '#/components/schemas/PlaceSelection'
        optionality:
          description: >-
            INCLUDED: the reservation is included in the offer
            MANDATORY: the reservation is mandatory for the booking
            OPTIONAL: the reservation is not included but can be added optionally
          type: string
          x-extensible-enum:
            - INCLUDED
            - MANDATORY
            - OPTIONAL
        ancillaries:
          type: array
          items:
            type: object
            properties:
              relationType:
                type: string
                x-extensible-enum:
                  - OPTIONAL
                  - INCLUDED
              ancillary:
                $ref: '#/components/schemas/OfferPartReference'
        fees:
          type: array
          items:
            $ref: '#/components/schemas/OfferPartReference'
      required:
        - id
        - commonOfferPartAttributes
        - reservationDetails
              
    Ancillary:
      type: object
      properties:
        id:
          type: string
        commonOfferPartAttributes:
          $ref: '#/components/schemas/CommonOfferPartAttributes'
        optionality:
          description: >-
            INCLUDED: the ancillary is included in the offer but is not mandatory 
            OPTIONAL: the ancillary is not included but can be optionally added
          type: string
          x-extensible-enum:
            - INCLUDED
            - OPTIONAL
        category:
          type: string
        fees:
          type: array
          items:
            $ref: '#/components/schemas/OfferPartReference'
      required :
        - id
        - commonOfferPartAttributes

    Fee:
      type: object
      properties:
        id:
          type: string
        abstract:
          type: string
          example: Reservierungsentgelt
        price:
          $ref: '#/components/schemas/Price'
        applicability:
          type: string
          x-extensible-enum:
            - BOOKING
            - TRIP
            - OFFERPART
        providerBookingReference:
          type: string
          description: >-
            The booking reference of the booking the offer part is in on the provider side.
        refundable:
          type: string
          enum:
            - YES
            - NO
            - WITH_CONDITIONS
        conditions:
          type: array
          items:
            $ref: '#/components/schemas/Condition'
          description: >-
            Structured description of the sales or after-sales conditions.
        productCode:
          type: string
          description: >-
            The product code expressed in the provider system (could be a
            mapping from an even lower-level provider).
          example: Reservierungsentgelt
      required :
        - id
        - price
          
    OfferPartReference:
      type: object
      description: >-
        References all the offer part elements in an uniform format.
        In its part, an OfferPartReference can refer to reservation, admission, ancillary or fee.
      properties:
        id:
          type: string
          format: uuid
        abstract:
          type: string
          example: ICE Wifi on Board 2020-07-11
        links:
          type: array
          items:
            $ref: '#/components/schemas/Link'
      required:
        - id
    
    OfferSelection:
      type: object
      properties:
        selectedOfferId:
          type: string
          format: uuid
          description: id of the selected offer or exchangeOffer
        afterSaleByDistributorOnly:
          description: >-
            in case the distributor has proposed this offer in conjunction with an offer of another provider constrained
            by a combinationTag, this flag must be set to true to indicate to the provider that after-sale must be done 
            on the totality of the distributor's booking. Only after-sale requests triggered by the distributor can be 
            safely processed on this offer. When the flag is not set, standard provider logic applies.
          type: boolean
          default: false
        throughTicketTag:
          description: >-
            in case the carriage contracts represented by this offer have been grouped with carriage contracts from other
            providers by the distributor. The same trhoughTicketTag that was used to perform the grouping can be specified here.
          type: string
          default: false
        selectedOptionalReservationsIds:
          type: array
          items:
            type: string
            format: uuid
            description: >-
              If relevant, ids of the selected optional reservations.
        selectedOptionalAncillaries:
          type: array
          items:
            type: object
            properties:
              ancillaryId:
                type: string
                format: uuid
                description: >-
                  If relevant, ids of the selected optional ancillaries.
              passengerIds:
                type: array
                items:
                  type: string
                  format: uuid
                  description: >-
                    Id of the passengers the selected optional ancillaries are for. 
        passengers:
          type: array
          items:
            $ref: '#/components/schemas/Passenger'
          description: >-
            If needed (cf requiredInformation) or desired, this array allows providing the required details on some or all passengers    
        placeSelections:
          type: object
          properties:
            reservationId: 
              type: string
              format: uuid
            placeSelection:
              $ref: '#/components/schemas/PlaceSelectionPatch'
      required:
        - selectedOfferId       

    BookingRequest:
      type: object
      properties:
        selectedOffers:
          type: array
          items:
            $ref: '#/components/schemas/OfferSelection'
          description: >-
            The list of offers that need to be provisionally booked, with possibly the reservations and ancillaries associated that should be booked as well. 
        embed:
          description: >-
            Influences whether referenced resources are returned in full or as references only.
          type: array
          items:
            type: string
            enum:
              - ALL
              - BOOKEDOFFERS
              - BOOKEDOFFERS.TRIPS
              - BOOKEDOFFERS.TRIPS.LOCATIONS
              - BOOKEDOFFERS.OFFERPARTS
              - PASSENGERS
              - REFUND_PROPOSITIONS
              - NONE
          default: [ALL]
      required:
        - selectedOffers
      
    Booking:
      type: object
      properties:
        id:
          type: string
          format: uuid
        abstract:
          type: string
          example: booking 2345
        reference:
          type: string
          description: >-
            The unique booking reference in the provider system. Usually refers to an order number or PNR.
        status:
          $ref: '#/components/schemas/BookingStatus'
        provisionalPrice: 
          $ref: '#/components/schemas/Price'
        confirmedPrice: 
          $ref: '#/components/schemas/Price'
        requestedInformation:
          $ref: '#/components/schemas/RequestedInformation'
        ticketTimeLimit:
          type: string
          format: date-time
        fulfillmentType:
          $ref: '#/components/schemas/FulfillmentType'
        bookedOffers:
          type: array
          items:
            $ref: '#/components/schemas/Offer'
        passengers:
          type: array
          items:
            $ref: '#/components/schemas/Passenger'
        fulfillments:
          type: array
          items:
            $ref: '#/components/schemas/Fulfillment'
        refundOffers:
          type: array
          items:
            $ref: '#/components/schemas/RefundOffer'
          description: >-
            Refund offers are created with the details of the to-be-confirmed refund operation. 
            One refund offer can then be confirmed, which turns it into a refund.
        exchangeOperations:
          type: array
          items:
            $ref: '#/components/schemas/ExchangeOperation'
        links:
          type: array
          items:
            $ref: '#/components/schemas/Link'
      required:
        - id
        - type

    BookingStatus:
      type: string
      enum:
        - PREBOOKED
        - CONFIRMED
        - FULFILLED
        - CANCELLED
        - REFUNDED
        - EXCHANGE_ONGOING
        - ERROR

    FulfillmentType:
      type: string      
      x-extensible-enum:
          - ETICKET
          - CIT_PAPER
          - PASS_CHIP
          - PASS_REFERENCE

    BookingPatchRequest:
      type: object
      description: >-
        Allows setting the required fulfillment type, e.g. value paper
        or e-ticket and preferred fulfillment media. 
        The latter is optional and relevant in some cases only.
      properties:
        requestedFulfillmentType:
          $ref: '#/components/schemas/FulfillmentType'
        preferredFulfillmentMedia:
          $ref: '#/components/schemas/FulfillmentMediaType'
        selectedExchangeOffers:
          type: array
          items:
            $ref: '#/components/schemas/OfferSelection'
    
    BookingSearchParameter:
      type: object
      description: >-
        parameter to be used to search for a booking. Contains personal data. 
        For a search via personal data an exact match of all elements 
        - first name, last name and date of birth - is mandatory. 
        In case a ticket holder is indicated the parameter must match the ticket holder. 
        TODO - legal check by CIT
      properties:
        passengerFirstName:
          type: string
          description: >-
            First name of a passenger in the booking.      
        passengerLastName:
          type: string
          description: >-
            Last name of a passenger in the booking.
        passengerDateOfBirth:
          type: string
          format: date
          description: >-
            Date of birth of a passenger in the booking.
        bookingReference:
          type: string
          format: date
          description: >-
            Human-readable booking reference for the booking, e.g. PNR.
        fulfillmentReference:
          type: string
          description: >-
            Human-readable fulfillment reference for the booking, e.g. ticket number.
        travelDateBegin:
          type: string
          format: date-time
          description: >-
            Begin date for the travel date range to search.
        travelDateEnd:
          type: string
          format: date-time
          description: >-
            End date for the travel date range to search.
        origin: 
          $ref: '#/components/schemas/Place'
        destination:
          $ref: '#/components/schemas/Place'

    BookingSearchReply:
      type: object
      description: >-
        Reply on a search for bookings
      properties:
        bookings:
          type: array
          items: 
            $ref: '#/components/schemas/Booking'

    FulfillmentOption:
      type: object
      description: >-
        CIT paper implies printing on value paper which is stock controlled.
      properties:
        type:
          $ref: '#/components/schemas/FulfillmentType'
        media: 
          type: array
          items:
           $ref: '#/components/schemas/FulfillmentMediaType'
        
    FulfillmentsPatch:
      type: object
      description: >-
        Changes the fulfillment to status FULFILLED.
      properties:
        fulfillmentUpdates:
          type: array
          items:
            type: object
            properties:
              fulfilledFulfillmentId:
                type: string
                format: uuid
                
    Fulfillment:
      type: object
      description: >-
        A fulfillment is a document (or part of a document in allocator mode) that
        - allows the passenger to prove its travel right
        - provides easier access to trains and stations
        - allows an exchange for other services (voucher)
        A fulfillment refers to services of one or multiple offer parts or a fare (allocator mode).
      properties:
        id:
          type: string
          format: uuid
        status: 
          $ref: '#/components/schemas/FulfillmentStatus'
        price:
          $ref: '#/components/schemas/Price'
          description: >-
            Note the price is present here as an optional element as future evolution indicate a possible
            separation between fulfillment info and financial information. 
            Please refer to UIC leaflet XXX for more information on current status.
        controlNumber:
          type: string
          description: >-
            Ticket Control Number
        offerParts:
          type: array
          items:
            $ref: '#/components/schemas/OfferPartReference'
        documents:
          description: >-
            complete document created for fulfillment
          type: array
          items: 
            $ref: '#/components/schemas/FulfillmentDocument'
        fulfillmentItems:
          description: >-
            fulfillment items to be integrated into tickets (allocator mode)
          type: array
          items:
            $ref: '#/components/schemas/FulfillmentItem'
        links:
          type: array
          items:
            $ref: '#/components/schemas/Link'
      required:
       - id
    
    FulfillmentStatus:
      type: string
      enum: 
        - CONFIRMED
        - FULFILLED
        - CHECKEDIN
        - REFUNDED

    FulfillmentDocument:
      type: object
      description: >-
        Document created for fulfillment. Either downloadLink + downloadExpiry or content + format must
        be provided.
      properties:
        medium: 
          $ref: '#/components/schemas/FulfillmentMediaType'
        type:
          type: string
          x-extensible-enum:
            - BOOKING_RECEIPT
            - TICKET
            - BOARDING_PASS
            - INFORMATION
            - VOUCHER
        downloadLink:
          type: string
          format: uri
        downloadExpiry:
          type: string
          format: date-time
          description: >- 
            Expiration time of the download link, the document will not be available at the given URI 
            after this time.
        content:
          type: string
          format: base64
          description: base64 encoded binary of the actual fulfillment document
        format:
          type: string
          example: "application/pdf"
          description: >-
            Physical format of the document provided in the content field in Mime-Type format, e.g. 
            application/pdf, image/jpeg, etc. Must be filled if the "content" field is present.
    
    FulfillmentItem:
      type: object
      description: >-
       Fulfillment items to be integrated in to tickets, 
       e.g. visual security elements, additional bar codes, control keys.
      properties:
        fulfillmentMedia:
          description: >-
           list of fulfillment media where this item applies
          type: array
          items:
           $ref: '#/components/schemas/FulfillmentMediaType'
        travelerReference:
          description: reference to a traveler
          type: string
        controlId:
          type: string
        securityFeatures:
          description: 'visual elements, bar codes'
          type: array
          items:
            type: object
            properties:
              type:
                $ref: '#/components/schemas/SecurityFeatureType'
              data:
                description: base 64 encoded data
                type: string
        securityFeatureLinks:
          type: array
          items:
            type: object
            properties:
              type:
                $ref: '#/components/schemas/SecurityFeatureType'
              uri:
                description: link to download the security feature
                type: string
                format: uri
        isMandatory:
          description: >-
            The use of the provided features is mandatory.
          type: boolean
          default: false
        securePaperOnly:
          description: >-
            The security feature must be used on secure paper.
          type: boolean
          default: false
  
    SecurityFeatureType:
      description: >-
        Defines type and format of the security feature.
      type: object
      properties:
        type:
          type: string
          enum:
            - VISUAL_ELEMENT
            - BAR_CODE
        format:
          type: string
          enum:
            - PNG
            - GIF
            - SVG   
      
    RefundOffersCollection:
      type: object
      properties:
        refundOffers:
          type: array
          items:
            $ref: '#/components/schemas/RefundOffer'
  
    RefundOffer:
      type: object
      properties:
        id:
          type: string
          description: id of the refund offer
        abstract:
          type: string
          example: Refund Paris-Barcelona Andre Dupont 2020-07-23
        validUntil:
          type: string
          format: date-time
        status:
          type: string
          enum:
            - PROPOSED
            - CONFIRMED
        reimbursementStatus:
          description: >-
            If set to IMMEDIATE the distributor is allowed to return the 
            reimbursement amount immediately.
          type: string
          enum:
            - IMMEDIATE
            - DELAYED
          default: IMMEDIATE
        reimbursementDateTime:
          type: string
          format: date-time
        appliedOverruleCode:
          description: >-
            Reason for and type of an after sale, Code list in IRS 90918-10.
          type: string
        fulfillments:
          type: array
          items: 
            $ref: '#/components/schemas/Fulfillment'
        refundFee:
          $ref: '#/components/schemas/Price'
        refundableAmount:
          $ref: '#/components/schemas/Price'
        links:
          type: array
          items:
            $ref: '#/components/schemas/Link'
      required:
       - id

    RefundOfferRequest:
      type: object
      description: >-
        Request for a refund offer. 
        Fulfillments can be provided in case the booking contains multiple individual fulfillments.
      properties:
        fulfillmentIds:
          type: array
          items:
            type: string
            format: uuid
            description: id of the fulfillment to refund
        overruleCode: 
          $ref: '#/components/schemas/OverruleCode'
        refundDate:
          type: string
          format: date-time
          description: >-
            Indicates for passes the date taken as reference to compute possible partial refund. It is also the date taken
            as reference to invalidate the pass partilly refunded.
      required:
        - fulfillmentIds

    RefundOfferConfirm:
      type: object
      description: >-
        Changes the refund offer to status CONFIRMED.
      properties:
        confirmedRefundOfferId:
          type: string
          format: uuid
          description: id of the refund offer
      required:
        - confirmRefundOfferId 
 
    OverruleCode: 
      type: string
      description: >-
        Reason for and type of an after sale, code list in IRS 90918-10.
        The PRM_SUPPORT_UNAVAILABLE overrule code shall only be used by
        the UIC PRM ABT tool.
      x-extensible-enum:
        - PAYMENT_FAILURE
        - PRM_SUPPORT_UNAVAILABLE
        - SALES_STAFF_ERROR
        - STRIKE

    ExchangeTripOfferRequest:
      type: object      
      description: >-
        Defines the parameters needed to request an exchange offer, either based on either an
        existing trip (that is then passed in) plus a set of offer search
        criteria, or based on tripsearch and offer search criteria. At least one
        of the trip or tripSearchCriteria must be set.
      properties:
        tripOfferRequest:
          $ref: '#/components/schemas/TripOfferRequest'
        fulfillmentIds:
          type: array
          items:
            type: string
            format: uuid
        overruleCode: 
          $ref: '#/components/schemas/OverruleCode'
      required:
        - tripOfferRequest
        - fulfillmentIds

    ExchangeTripOffer:
      type: object
      properties:
        id:
          type: string
        abstract:
          type: string
          example: Bruxelles-Midi 2020-07-01 10:05 CET
        trip:
          $ref: '#/components/schemas/Trip'
        exchangeOffers:
          type: array
          items:
            $ref: '#/components/schemas/ExchangeOffer'
        passengers:
          type: array
          items:
            $ref: '#/components/schemas/Passenger'
        fulfillments:
          type: array
          items:
            $ref: '#/components/schemas/Fulfillment'
        links:
          type: array
          items:
            $ref: '#/components/schemas/Link'
      required: 
        - id
        - trip

    ExchangeOperation:
      type: object
      properties:
        id:
          type: string
          format: uuid
        abstract:
          type: string
          example: booking 2345
        status:
          type: string
          enum:
            - PREBOOKED
            - CONFIRMED
            - FULFILLED
            - ERROR          
        exchangeOffers:
          type: array
          items:
            $ref: '#/components/schemas/ExchangeOffer'
        fulfillments:
          type: array
          items: 
            $ref: '#/components/schemas/Fulfillment'        
        ticketTimeLimit:
          type: string
          format: date-time
        fulfillmentType:
          $ref: '#/components/schemas/FulfillmentType'

    ExchangeOperationPatchRequest:
      type: object
      description: >-
        Allows modifying a general setting for the booking:
         * setting the required fulfillment type, e.g. value paper
           or e-ticket and preferred fulfillment media. 
           The latter is optional and relevant in some cases only.
         * Provisionally exchanging some of the fulfillments in the booking 
      properties:
        requestedFulfillmentType:
          $ref: '#/components/schemas/FulfillmentType'
        preferredFulfillmentMedia:
          $ref: '#/components/schemas/FulfillmentMediaType'
        embed:
          description: >-
            Influences whether referenced resources are returned in full or as references only.
          type: array
          items:
            type: string
            enum:
              - ALL
              - TRIP
              - TRIP.LOCATIONS
              - OFFERS
              - OFFERS.OFFERPARTS
              - OFFERS.OFFERPARTS.PRODUCTS
              - PASSENGERS
    
    ExchangeOffer:
      type: object
      properties:
        offer:
          $ref: '#/components/schemas/Offer'
        exchangeFee:
          $ref: '#/components/schemas/Price'
        exchangePrice:
          $ref: '#/components/schemas/Price'    

    NonTripOfferSearch:
      type: object
      description: >-
        Search parameter for an offer search on offers not based on a trip (e.g. passes).
      properties:
        searchTags:
          description: >-
            list of tags to search for
          type: array
          items:
            type: string
        nutsCodes:
          description: >-
            Nomenclature des units territoriales statistiques COMMISSION REGULATION (EU) No 31/2011
          type: array
          items:
            type: string
        geoCoordinate:
          $ref: '#/components/schemas/GeoCoordinate'
        travelPeriod:
          type: array
          items:
            type: string
            format: date-time
        passengers:
          type: array
          items:
            $ref:  '#/components/schemas/Passenger'  
        requestedFulfillmentOptions: 
          type: array
          items:
            $ref:  '#/components/schemas/FulfillmentOption' 
        nonTripOfferSearchCriteria:
            $ref:  '#/components/schemas/NonTripOfferSearchCriteria'
        embed:
          description: >-
            Influences whether referenced resources are returned in full or as references only. 
          type: array
          items:
            type: string
            enum:
              - OFFERPARTS
              - NONE
              - ALL
          default: [ALL]
                 
    NonTripOffer:
      type: object
      description: >-
        Non trip offers do not reference a trip, thus no reservations can be offered by definition.     
      properties:
        id:
          type: string
        abstract:
          type: string
          example: Super Saver One Day Pass
        offerSummary:
          $ref: '#/components/schemas/OfferSummary'
        requestedInformation:
          $ref: '#/components/schemas/RequestedInformation'
        validFrom:
          type: string
          format: date-time
        validUntil:
          type: string
          format: date-time 
        availableFulfillmentTypes:
          type: array
          items:
            $ref: '#/components/schemas/FulfillmentType'
        admissions:
          type: array        
          items: 
            $ref: '#/components/schemas/Admission'
        ancillaries:
          type: array        
          items:  
            $ref: '#/components/schemas/Ancillary'
        fares:
          type: array
          items:
            $ref: '#/components/schemas/FareOnline'
        links:
          type: array
          items:
            $ref: '#/components/schemas/Link'
      required:
        - id

    CoachLayout:
      type: object
      description: >-
        coach layout providing data to draw a coach layout. The items of a coach
        are located via coordinates with (0,0) in the upper left corner. All
        coordinates are given without sign. 
      properties:
        id:
          type: string
          description: unique id of this coachLayout on this server
        abstract:
          type: string
          example: coach 3 train T122
        places:
          description: list of places included in the layout
          type: array
          items:
            type: object
            properties:
              number:
                description: place number as displayed physically on the place
                type: string
              direction:
                description: >-
                  Direction of a place, defined optional as it might be omitted in
                  case of berths in future. 
                  Code list according to UIC90918-1
                   - RIGHT: to right
                   - LEFT: to left
                   - UP: up (from right side of a coach pointing to the middle of the aisle)
                   - DOWN: down (from right side of the coach pointing to the middle of the aisle)
                type: string
                enum:
                  - RIGHT
                  - LEFT
                  - UP
                  - DOWN
              remarkId:
                description: >-
                  Remark concerning the place (e.g. to be used in a tool tip).
                  Code list according to UIC90918-1 
                   - value 1: place might have a table
                   - value 2: table at the place might be missing 
                   - value 3: place might have a different direction 
                   - value 4: place might have a table and a different direction 
                   - value 5: table at the place might be missing and place might have a different direction
                   - value 6: place might be in compartment
                   - value 7: place might be in open space  
                type: string
                x-extensible-enum:
                 - VALUE1-TODO
              coords:
                $ref: '#/components/schemas/LayoutCoordinates'             
            required:
              - id
              - number
              - coords
        signs:
          type: array
          items:
            type: object
            properties:
              icon:
                description: >-
                  Icon type of the graphical item type. Code list according to UIC90918-1
                  graphical item type e.g. silence area sign = 116
                type: string
              coords:
                $ref: '#/components/schemas/LayoutCoordinates'
            required:
              - icon
              - coords
        internals:
          type: array
          items:
            type: object
            properties:
              icon:
                description: >-
                  icon type of the graphical item type. Code list according to UIC90918-1
                  graphical item type e.g. seat = 1, berth = 2, couchette = 3
                type: string
              mounting:
                description: >-
                  indicates, that the item is located at the upper border (U), the
                  lower border (L), goes from upper to lower border (E) or is
                  placed free (F).
                type: string
                enum:
                  - UPPER_BORDER
                  - LOWER_BORDER
                  - UPPER_TO_LOWER_BORDER
                  - FREE
              coords:
                $ref: '#/components/schemas/LayoutCoordinates'
            required:
              - icon
              - coords
        gridSize:
          type: object
          properties:
            x:
              type: integer
              format: int32
            y:
              type: integer
              format: int32
        links:
          type: array
          description: Context information required by the services.
          items:
            $ref: '#/components/schemas/Link'
      required:
        - id

    LayoutCoordinates:
      type: object
      properties:
        x:
          description: >-
            horizontal coordinate of the center of the place
          type: integer
          format: int32
        y:
          description: >-
            vertical coordinate of the center of the place
          type: integer
          format: int32
        zOrder:
          description: >-
            Graphical layer where this item has to be placed. 
            Code list according to UIC90918-1
              - value 0: lowest layer usually used for walls 
              - value 1: middle layer usually used by places
              - value 2: top layer usually used by icons
          type: string
      required:
        - x
        - y
        - zOrder

    Problem:
      type: object
      description: >-
        Problem Details for HTTP APIs (RFC 7807) defines a "problem detail" as a way
        to carry machine-readable details of errors in a HTTP response to avoid
        the need to define new error response formats for HTTP APIs.
        See: https://tools.ietf.org/html/rfc7807
      properties:
        type:
          type: string
          format: uri
          description: >-
            An absolute URI that identifies the problem type. When dereferenced,
            it SHOULD provide human-readable documentation for the problem type
            (e.g., using HTML).
          default: 'about:blank'
          example: 'https://example.com/probs/passenger-too-young'
        title:
          type: string
          description: >-
            A short, summary of the problem type. Written in English and readable
            for engineers (usually not suited for non technical stakeholders and
            not localized); example: Service Unavailable
        status:
          type: integer
          format: int32
          description: >-
            The HTTP status code generated by the origin server for this occurrence
            of the problem.
          minimum: 100
          maximum: 600
          exclusiveMaximum: true
          example: 503
        detail:
          type: string
          description: >-
            A human readable explanation specific to this occurrence of the
            problem.
          example: Connection to database timed out
        instance:
          type: string
          format: uri
          description: >-
            An absolute URI that identifies the specific occurrence of the problem.
 
    AvailablePlacePreferences:
      type: object
      properties:  
          placePacks:
            description: >-
              Properties of the available places for the provided selection query       
            type: array    
            items:
              type: object
              properties:
                accommodationType:
                  $ref: '#/components/schemas/AccommodationType'  
                accommodationSubType:
                  $ref: '#/components/schemas/AccommodationSubType'  
                passengerReferences:
                  description: reference of the traveller / reservation holder
                  type: string  
                number:
                  description: number of places 
                  type: integer
                  format: int32
                availablePlaceProperties:
                  description: >-
                   Properties of the available places for the provided selection query
                  type: array    
                  items:
                    type: object
                    description: place properties of places in the place pack. Properties without a  number refer to all places
                    properties:
                      placeProperty:
                        description: see code list
                        type: string
                      number:
                        description: number of places with this property
                        type: integer
                        format: int32
                      priority:
                        description: priority for displaying a list of properties
                        type: integer
                        format: int32
 
 
    #### Fare-specific elements begin

    FareOnline:
      type: object
      properties:
        id:
          description: unique id of the fare item to be included in accounting
          type: string
        type:
          $ref: '#/components/schemas/FareType'
        name:
          $ref: '#/components/schemas/Text'
        description:
          $ref: '#/components/schemas/Text'
        price:
          type: object
          description: allows specifying a price in multiple currencies
          properties:
            price:
              type: array
              minItems: 1
              items:
                $ref: '#/components/schemas/Price'
        regionalConstraint:
          type: object
          description: >-
            Regional constraint of the fare- offline bulk data use the id of connection points whereas in an online environment the connection point is included
          properties:
            entryConnectionPointId:
              description: connection point connecting two fare regimes
              type: string
            entryConnectionPoint:
              $ref: '#/components/schemas/FareConnectionPoint'
            exitConnectionPointId:
              description: connection point connecting two fare regimes
              type: string
            exitConnectionPoint:
              $ref: '#/components/schemas/FareConnectionPoint'
            regionalValidity:
              $ref: '#/components/schemas/RegionalValidity'
            distance:
              description: Distance in km for statistics
              type: integer
              format: int32
          required:
            - regionalValidity         
        serviceConstraint:
            $ref: '#/components/schemas/ServiceConstraint'
        carrierConstraint:
          type: object
          description: >-
            Either excluded or included carriers can be set.
          properties:
            restrictedToCarrier:
              type: array
              items:
                type: string
            excludedCarrier:
              type: array
              items:
                type: string
        regulatoryConditions:
          $ref: '#/components/schemas/RegulatoryConditions'
        serviceClass:
          $ref: '#/components/schemas/ServiceClass'
        comfortClass:
          $ref: '#/components/schemas/ComfortClass'
        accommodationDetail:
          type: object
          properties:
            accommodationType:
                $ref: '#/components/schemas/AccommodationType'  
            accommodationSubType:
                $ref: '#/components/schemas/AccommodationSubType'              
            text:
              $ref: '#/components/schemas/Text'
            isClassNameExcluded:
              description: indicates that the class name is included
              type: boolean
              default: false
            reservationParameterId:
              type: string
          required:
            - id
            - text          
        afterSalesCondition:
          type: object
          properties:
            conditions:
              type: array
              minItems: 1
              items:
                $ref: '#/components/schemas/Condition'
              description: >-
                Structured description of the sales or after-sales conditions.
            isSupportingIndividualContracts:
              description: Indicates that the after sales of this fare can be treated independently per person.
              type: boolean
              default: false
        combinationConstraint:
          type: object
          properties:
            combinationModels:
              type: array
              minItems: 1
              items:
                $ref: '#/components/schemas/FareCombinationModel'
          required:
            - combinationModels
        fulfillmentConstraint:           
          type: object
          properties:
            acceptedControlSecurityTypes:
              type: array
              minItems: 1
              items:
                $ref: '#/components/schemas/ControlSecurityType'
            acceptedBarCodes:
              description: for SiD fulfillment one of the listed bar codes is required
              type: array
              items:
                description: >-
                  Item according to IRS 90918-9: FCB, TLB, SSB
                type: string
                x-extensible-enum:
                  - FCB
                  - TLB
                  - SSB
            requiredBarCodes:
              description: >-
                One of the listed bar codes must be provided.
              type: array
              items:
                type: string
            requiredSiS:
              description: >-
                To guarantee security in system (SiS) of the fulfillment one of the listed interfaces is required.
              type: array
              items:
                description: >-
                  Interface type to ticket control data. REGISTRY means submitting
                  the data to the central UIC registry. PEER_TO_PEER means data exchange
                  is handled between the two parties directly.
                type: string
                x-extensible-enum:
                  - REGISTRY
                  - PEER_TO_PEER
            isIndividualTicketingForbidden:
              description: a separate fulfillment per traveler is forbidden
              type: boolean
              default: false
          required:
            - acceptedFulfillmentTypes
        reductionConstraint:
          type: object
          properties:
            requiredCards:
              description: >-
                One of the listed cards is required to be valid at the time of travel.
              type: array
              items:
                $ref: '#/components/schemas/CardReference'
          required:
            - requiredCards
        legacyAccountingIdentifier:
          type: object
          description: identifier of the fare in the current 301 accounting file
          properties:
            serialId:
              description: sequential number of regional validities
              type: integer
              format: int32
              minimum: 0
              maximum: 99999
            addId:
              description: >-
                Sequential number of regional validities (leading positions in case the series is too short
              type: integer
              format: int32
              minimum: 0
              maximum: 99
            tariffId:
              description: sequential number of the fares for one regional validity
              type: integer
              format: int32
              minimum: 0
              maximum: 9999
        travelValidityConstraint:
          type: object
          description: >-
            travel validity data are needed to create barcode and control data (ETCD)
            in allocator mode even in case they have been checked during the online sale
          properties:
            validTravelDates:
              $ref: '#/components/schemas/CalendarOnline'
            validityRange:
              type: object
              properties:
                timeUnit:
                  type: string
                  enum:
                    - DAYS
                    - HOURS
                    - MINUTES
                value:
                  type: integer
                  format: int32
                hoursAfterMidnight:
                  description: validity extended after midnight
                  type: integer
                  format: int32
              required:
                - timeUnit
                - value  
            excludedTimeRange:
              description: time ranges excluded from the validity (e.g. off peak fulfillments)
              type: array
              items:
                type: object
                properties:
                  from:
                    description: minutes of the day in the time zone of travel
                    type: integer
                    format: int32
                  until:
                    description: minutes of the day in the time zone of travel
                    type: integer
                    format: int32
                  scope:
                    type: string
                    enum:
                      - START_OF_TRAVEL
                      - COMPLETE_RANGE
                required:
                  - from
                  - until
                  - scope
            numberOfTravelDays:
              description: number of allowed travel days (e.g. 3 travel days within 2 weeks)
              type: integer
              format: int32
            returnConstraint:
              description: a return trip with the same carrier must be sold in combination
              type: object
              properties:
                latestReturn:
                  description: number of days after departure or start of validity of the last return
                  type: integer
                  format: int32
                earliestReturn:
                  description: number of days after departure or start of validity of the earliest return
                  type: integer
                  format: int32
                excludedWeekdays:
                  description: weekdays (ISO day of the week, 1 = Monday) between travel and return where travel is not allowed
                  type: array
                  items:
                    type: integer
                    format: int32
              required:
                - latestReturn
                - earliestReturn
            trainValidity:
                 $ref: '#/components/schemas/TrainValidity'                
          required:
            - validityRange
        reservationDetails:
          $ref: '#/components/schemas/ReservationDetail'     
        placeSelection:
          $ref: '#/components/schemas/PlaceSelection'
        legacyReservationParameter:
          type: object
          description: reservation parameter to support the UIC 90918-1 interface for booking
          properties:
            travelClass:
              description: 90918-1 class code in reservation
              type: string
            serviceLevelCode:
              description: service level code defined in UIC 90918-1
              type: string
            serviceCode:
              description: service code to be used in reservation
              type: string
            berthType:
              description: berth type code in UIC 90918-1 to be used in reservation
              type: string
            coachTypeCode:
              description: coach type code in UIC 90918-1 to be used in reservation
              type: string
            compartmentTypeCode:
              description: compartment type code in UIC 90918-1 to be used in reservation
              type: string
            tariff:
              description: tariff according to UIC 90918-1 to be used for booking 
              type: array
              items:
                $ref: '#/components/schemas/LegacyReservationTariff'
          required:
            - travelClass
            - serviceLevelCode
            - serviceCode
        coveredSection:
          type: object
          properties:
            start:
              $ref: '#/components/schemas/Place'
            end:
              $ref: '#/components/schemas/Place'
          required:
            - start
            - end
        passengerConstraint:
          description: >-
            passenger constraint to be included in bar codes
          type: array
          items: 
            type: object
            properties:
                number:
                    description: number of passengers with this constraint
                    type: integer
                    format: int32                 
                upperAgeLimit:
                    type: integer
                    format: int32
                lowerAgeLimit:
                    type: integer
                    format: int32
      required:
        - id
        - type
        - regionalConstraint
        - combinationConstraint
        - travelValidityConstraint
        - afterSalesCondition

    RegulatoryConditions:
      description: >- 
         General conditions applied to cover legal regulations within the area of validity. allocators must reflect these terms and
         conditions in the conditions of combined offers and indicate them to the customer where required. Which indications are
         mandatory to be shown to the customer will be defined in the SCICs
          - CIV: terms and conditions according to COTIV regulation
          - MD:  terms and conditions according to SMPS regulation
          - EU-PRR: terms and conditions according to EU-PRR regulation
      type: array
      items: 
         type: string
         enum:
         - CIV
         - MD
         - EU-PRR

    CalendarOnline:
      type: object
      properties:
        fromDate:
          type: string
          format: date-time
        untilDate:
          type: string
          format: date-time
        dates:
          description: >-
            dates included in the calendar. In case no dates are provided the range is assumed to be valid
          type: array
          items:
            type: string
            format: date-time
        utcOffset:
          description: >- 
            offset to UTC in minutes (number of minutes to be added to get UTC dates)
          type: integer
          format: int32

    FareCombinationModel:
      type: object
      properties:
        model:
          description: >-
            Possible models are SEPARATE_TICKET, SEPARATE_CONTRACT, CLUSTERING, COMBINING. 
            The models need to be supported by the allocator.
          type: string
        combinableCarrier:
          description: >-
            List of all carriers where the model can be applied, in case the list is empty
            all combinations are allowed.
          type: array
          items:
            $ref: '#/components/schemas/Company'
        isValidOnlyWhenCombined:
          description: >-
            This combination model applies only in case the fare is combined with another carrier
          type: boolean
          default: false
        referenceCluster:
          description: >-
            In case of CLUSTERING model: the cluster to which the fare belongs
          type: string
        allowedClusters:
          description: >-
            In case of CLUSTERING model: the other clusters that allow a combination
          type: array
          items:
            type: string
        allowedCommonContracts:
          description: >-
            List of carriers where a common contract with separate fulfillments are allowed.
          type: array
          items:
            $ref: '#/components/schemas/Company'
      required:
        - model
        
    ServiceConstraint:
      type: object
      description: >-
          Either excluded or included service brands can be set.
      properties:
        restrictedToServiceBrands:
          type: array
          items:
            $ref: '#/components/schemas/ServiceBrandCode'
        excludedServiceBrands:
          type: array
          items:
            $ref: '#/components/schemas/ServiceBrandCode'          
        description:
          $ref: '#/components/schemas/Text'

    RegionalValidity:
      type: array
      items:
        type: object
        description: >- 
          One of the elements Zone, ViaStation, TrainLink, Line, or Polygon defining the regional validity
        properties:
          seqNb:
            description: order number of the list item
            type: integer
            format: int32
          zone:
            $ref: '#/components/schemas/Zone'
          viaStations:
            $ref: '#/components/schemas/ViaStations'
          trainLink:
            $ref: '#/components/schemas/TrainLink'
          line:
            $ref: '#/components/schemas/Line'
          polygon:
            $ref: '#/components/schemas/Polygon'
          serviceConstraint:
            $ref: '#/components/schemas/ServiceConstraint'
    
    Line:
      type: object
      description: >-
         terminalStation - in case the product requires a destination within the zone (e.g. local ticket 
         to go to the main rail station). 
         entryStation - Station to enter the zone in case the product requires to enter the zone via a 
         specific station (e.g. local zone ticket to start from the main rail station).
      properties:
        binaryLineId:
          type: string
          description: >-
            Id to support local traffic standards (e.g. VDV,...).
        carrier:
          $ref: '#/components/schemas/Company'
        city:
          type: integer
          format: int32
        entryStation:
          $ref: '#/components/schemas/StopPoint'
        lineId:
          type: array
          items:
            type: string
        terminalStation:
          $ref: '#/components/schemas/StopPoint'
        nutsCode:
          description: >-
            Nomenclature des units territoriales statistiques  
             COMMISSION REGULATION (EU) No 31/2011
          type: string
      required:
        - carrier
    
    TrainLink:
      type: object
      properties:
        fromStation:
          $ref: '#/components/schemas/StopPoint'
        toStation:
          $ref: '#/components/schemas/StopPoint'
        train:
          type: string
        travelDate:
          type: string
          format: date-time
          description: >-
            date and time of the departure where the train link starts
      required:
        - fromStation
        - toStation
        - train
        - travelDate
       
    Polygon:
      type: object
      properties:
        edge:
          type: array
          minItems: 1
          items:
            $ref: '#/components/schemas/GeoCoordinate'
    
    ViaStations:
      type: object
      properties:
        isBorder:
          type: boolean
          default: false
        routeId:
          type: integer
          format: int32
        seriesId:
          type: integer
          format: int32
        alternativeRoute:
          type: array
          items:
            $ref: '#/components/schemas/ViaStations'
        carrier:
          $ref: '#/components/schemas/Company'
        route:
          type: array
          items:
            $ref: '#/components/schemas/ViaStations'
        serviceBrand:
          $ref: '#/components/schemas/ServiceBrandCode'
        station:
          $ref: '#/components/schemas/StopPoint'
        fareReferenceStationSet:
          type: object
          description: reference to a list of stations included in the fare
          properties:
            carrier:
              $ref: '#/components/schemas/Company'
            code:
              type: string
            name:
              type: string
          required:
            - carrier
            - code
        serviceConstraint:
          $ref: '#/components/schemas/ServiceConstraint'
 
    Zone:
      type: object
      description: >-
        carrier - carrier responsible for the transport.
        entryStation - Station to enter the zone in case the product requires to enter the zone via a specific station
        (e.g. local zone ticket to start from the main rail station).
        terminalStation - Terminal station in case the product requires a destination within the zone (e.g. local ticket
        to go to the main rail station).
      properties:
        binaryZoneId:
          type: string
          format: base64
          description: 
            Id to support local traffic standards (e.g. VDV,...)
        carrier:
          $ref: '#/components/schemas/Company'
        city:
          type: integer
          format: int32
        entryStation:
          $ref: '#/components/schemas/StopPoint'
        terminalStation:
          $ref: '#/components/schemas/StopPoint'
        zoneIds:
          description: to be used in bar codes
          type: array
          items:
            type: integer
            format: int32
        nutsCode:
          description: Nomenclature des units territoriales statistiques COMMISSION REGULATION (EU) No 31/2011
          type: string
      required:
        - carrier
      
    ControlSecurityType:
      description: >-
        SIP: secure paper tickets; SID: security in data (signed bar code); SIS: security in system
      type: string
      x-extensible-enum:
        - SIP
        - SID
        - SIS

    LegacyReservationTariff:
       description: legacy tariff code and number of items or persons in case UIC 90918-1 is used for booking
       type: object
       properties:
          number:
            description: number of items with this tariff code
            type: integer
            format: int32
          code:
            description: legacy tariff code
            type: integer
            format: int32
  
    FareType:
      description: >-
        Basic UIC fare types used in 90918-10, 90918-4, and 90918-9.
      type: string
      x-extensible-enum:
        - ADMISSION
        - RESERVATION
        - INTEGRATED_RESERVATION
        - ANCILLARY

    FareConnectionPoint:
      type: object
      description: >-
        Connection point connecting two fare regimes. The connection is possible between stations of the two provided station sets.
        A legacy border point code might be provided as an additional code within the stations (code list BORDER_POINT). 
        In case the connection point is a real station this station is indicated. 
        In case the connection point is between stations for each side of the border real stations must be provided. 
        Multiple sets of station can be provided in the rare case that the connection point connects more than two station (A-B and A-C).
        Multiple stations within a set at one side of the border might be provided in case of changes (new stations build near the border). 
        
        Providing the UIC code for the station is mandatory. 
      properties:
        id:
          type: string
        name:
          type: string
        stationSets:
          type: array
          items:
            type: array
            items:
              $ref: '#/components/schemas/StopPointStructure'
      required:
        - id
        - stationSets
        
    TrainValidity:
      description: >-
        validity depending on boarding / leaving of a train. The ticket is valid
        from departure until the destination station in the train if departure or destination is within the from - until range. The validation can reference the departure or the destination time to decide the validity (e.g. Eurail/Interrail passes currently use the departure for the validity on night trains).
      type: object
      properties:
        from:
          type: string
          format: date-time
        until:
          type: string
          format: date-time
        carrier:
          type: array
          minItems: 1
          items:
            $ref: '#/components/schemas/Company'
        excludedServiceBrand:
          type: array
          items:
            $ref: '#/components/schemas/ServiceBrandCode'
        includedServiceBrand:
          type: array
          items:
            $ref: '#/components/schemas/ServiceBrandCode'
        scope:
          type: string
          enum:
            - BOARDING
            - ARRIVAL
      required:
        - from
        - until
      additionalProperties: false        

    ##### Fare-specific elements end

    #### Common elements start
    ## Referenced by distributor as well as allocator part

    Link:
      type: object
      description: >-
        The underlying system may provide additional links pointing on further
        information (such as HTML download links, web sites or extended APIs).
        Mechanism to add flexible extensions specific to an underlying system.
      properties:
        contentTypes:
          type: array
          example: '["application/json", "application/pdf"]'
          description: Possible content types of the resource.
          items:
            type: string
        href:
          type: string
          format: uri
          description: URL to the linked resource (no parameters needed).
          example: 'https://www.brussels.info/train-stations/'
        method:
          type: string
          example: GET
          description: HTTP method to call the action
        relation:
          type: string
          example: Get Map
          description: Relation of this link to the current entity.
        version:
          type: integer
          format: int32
          example: 1
          description: Version of the current relation.
      required:
        - contentTypes
        - href
        - relation

    Translation:
      type: object
      properties:
        language:
          type: string
          description: language code following RFC2616-sec14.4
        text:
          type: string
        shortText:
          type: string
      required:
        - language
        - text
    
    Text:
      type: object
      description: >-
        Directly included text in case of online services. Text must be encrypted in
        UTF-8 format.
      properties:
        id:
          type: string
        translations:
          type: array
          items:
            $ref: '#/components/schemas/Translation'
        text:
          type: string
        shortText:
          type: string
      required:
        - id
        - text

    Price:
      type: object
      minProperties: 1
      properties:
        currency:
          $ref: '#/components/schemas/Currency'
        amount:
          description: amount in cents
          type: integer
          format: int32
        scale: 
          description: scale of the amount - the number of positions after the comma
          type: integer
          default: 2
        vatDetails:
          type: array
          items:
            $ref: '#/components/schemas/VAT'
      required:
        - currency
        - amount

    Currency:
      description: ISO 4217 currency codes
      type: string
      example: CHF

    VAT:
      type: object
      properties:
        country:
          description: ISO 3166 2A codes
          type: string
          example: CH
        amount:
          description: amount in cents
          type: integer
          format: int32
          example: 5
        scale: 
          description: scale of the amount - the number of positions after the comma
          type: integer
          default: 2          
        percentage:
          type: number
          format: float
        taxId:
          type: string
        scope:
          $ref: '#/components/schemas/VatScope'
      required:
        - country
        - amount

    VatScope:
      description: scope where the VAT applies
      type: string
      x-extensible-enum:
       - INTERNATIONAL
       - NATIONAL
       - SHORT_DISTANCE
       - LONG_DISTANCE

    Company:
      description: >-
        RICS company code or the upcoming compatible ERA company code. In case proprietary codes are used on a bilateral base the 
        codes must have at least 5 positions and start with x
      type: string

    ServiceBrandCode:
      description: >-
        Service brand codes allowed in response, code list can be found on 
        [https://uic.org/passenger/passenger-services-group/article/service-brand-code-list]
        (https://uic.org/passenger/passenger-services-group/article/service-brand-code-list)
      type: integer
      format: int32
      example: TGV

    ServiceClass:
      type: object
      description: >-
        Class of service.
      properties:
        type:
          $ref: '#/components/schemas/ServiceClassType'
        carrierName:
          type: string
          description: >-
            the name the carrier itself uses to designate this specific service class
      required:
        - id
      
    ServiceClassType:
      type: string
      description: >-
        Type of quality level, finer grained than the comfort class.
      x-extensible-enum:
        - BEST
        - HIGH
        - STANDARD
        - BASIC

    Condition:
      type: object
      description: >-
        Describes sales and after sales conditions applicable to the product. 
        For a product to be refundable or exchangeable, at least one refund or exchange 
        (respectively) condition must be present.
      properties:
        type:
          type: string
          x-extensible-enum:
            - SALE
            - EXCHANGE
            - REFUND
            - TRAVEL
        description:
          type: string
        validFrom:
          type: string
          format: date-time
        validUntil:
          type: string
          format: date-time
        afterSalesFee:
          type: object
          properties:
            feePrice:
              $ref: '#/components/schemas/Price'
            isAllocatorFee:
              description: indicates whether the fee belongs to the allocator
              type: boolean
              default: false
      required:
        - type
        - description

    GeoCoordinate:
      type: object
      description: >-
        Used to provide any geo-encoded location, regardless of environment, using longitude and latitude coordinates.
      properties:
        system:
          description: >-
            geo coordinate system indication: 
             - WGS84 = WGS 84 standard system,
             - GRS80 = (outdated) GRS 80 coordinate system
          type: string
          x-extensible-enum:
            - WGS84
            - GRS80
          default: WGS84
        accuracy:
          description: accuracy of the provided coordinates to be used when comparing coordinates
          type: number
          format: float
          example: 0.00002
        latitude:
          description: >-
            Geographic coordinate that specifies the north-south position of a point on the earths surface
          type: number
          format: float
          example: 46.948825
        longitude:
          description: >-
            Geographic coordinate that specifies the east-west position of a point on the earths surface.            
          type: number
          format: float
          example: 7.439122
      required:
        - latitude
        - longitude

    ConnectionPoint:
      type: object
      description: >-
        Connection point connecting two fare regimes.
        Providing the UIC code for the station is mandatory. 
      properties:
        stations:
          type: array
          items:
            type: array
            items:
              $ref: '#/components/schemas/StopPointRef'
      required:
        - stations

    ReservationDetail:
      type: object
      description: >-
        Describes the details of the reserved place(s).
      properties:
        accommodationType:
          $ref: '#/components/schemas/AccommodationType'  
        accommodationSubType:
          $ref: '#/components/schemas/AccommodationSubType'  
        reservedPlaces:
          description: >-
            Reserved places in a confirmed reservation. 
            Multiple place packs are needed to combined person and bicycle reservations
          type: array
          items:
            $ref: '#/components/schemas/PlacePack'

    PlacePack:
      type: object
      description: >-
          selection of places with common properties
          description element - textual description of the places
          placeProperties is mandatory for allocator mode, for distributors the textual description is used
      properties:
        id:
          type: string
        passengerReferences:
          description: reference of the traveller / reservation holder
          type: string
        vehicle:
          description: vehicle number (e.g. train number)
          type: string  
        coach:
          type: string
        places:
          description: descriptive string of the places (e.g. 11-35,51)
          type: string
        placeIds:
          description: list of individual place numbers
          type: array
          items:
            type: string
        placeProperties:
          description: place properties to be indicated to the customer
          type: array
          items:
            type: object
            description: place properties of places in the place pack. Properties without a  number refer to all places
            properties:
              placeProperty:
                description: see code list
                type: string
              number:
                description: number of places with this property
                type: integer
                format: int32
              priority:
                description: priority for displaying a list of properties
                type: integer
                format: int32
            required:
              - placeProperty
      required:         
        - id
        - reference
        - vehicle
        - coach
        - places

    AccommodationType:
      type: string
      description:  >-
        Accommodation type definition out of AccommodationTypeCodeList
    AccommodationSubType:
      type: string
      description:  >-
        Accommodation type definition out of AccommodationSubTypeCodeList
    PlaceSelection:
      type: object
      description: >-
        Place selection options and selected options in an offer
        - optional place properties to choose from
        - selected optional place properties (selectedOptions)
        - selectable places for a graphical place selection 
        - selectedPlaces from a graphical place selection (selectedPlaces)
        - reference place for adjacent reservation (referencePlace)
      properties:
        reservationOptions:
          $ref: '#/components/schemas/ReservationOnlineOption' 
        vehicle:
          description: >-
            Vehicle / train number is necessary in case of train parts with different train numbers
          type: string
        referencePlace: 
          type: object
          description: selected place for an adjacent reservation (NEARBY)
          properties:
            placeNumber:
              type: string
            coachNumber:
              type: string
        selectedOptions:
          type: array
          items:
            $ref: '#/components/schemas/PlaceOptionsBundle'
        selectedCoach:
          $ref: '#/components/schemas/SelectedCoach'

    ReservationOnlineOption:
      type: object
      properties:
        preferences:
          description: possible preferences to be requested in reservation without changing the fare
          type: array
          items:
            $ref: '#/components/schemas/ReservationOptionGroup'
        graphicalReservation:
          description: graphical reservation is supported, interface type "NO","UIC_918",..
          type: string

    ReservationOptionGroup:
      type: object
      properties:
        preferenceGroup:
          type: string
          example: SEAT_DIRECTION
        preferences:
          type: array
          items:
            type: string
            example: 'FORWARD_FACING'
      required:
        - preferenceGroup
        - preferences

    PlaceOptionsBundle:
      type: object
      description: >-
        Place selection of places for reservation linked to passengers.
      properties:
        passengers:
          type: array
          items:
            $ref: '#/components/schemas/Passenger'
        selectedPlaceProperties: 
          description: Properties of places as defined in 90810-10.
          type: array
          items:
            description: selection from the optional place properties provided in the offer
            type: string
   
    PlaceAvailability:
      type: object
      description: >-
        Availability of places on coaches.
      properties:
        vehicle:
          $ref: '#/components/schemas/Vehicle'
        preSelection:
          description: suggested pre-selection of places
          type: array
          items:
            type: object
            properties:
              coach: 
                type: string
              place:
                type: string

    Vehicle:
      description: >-
        List of the coaches in a vehicle run ordered according to the physical
        ordering of the vehicle.
      type: array
      items:
        $ref: '#/components/schemas/Coach'

    Coach:
      type: object
      properties:
        compartments:
          type: array
          items:
            $ref: '#/components/schemas/Compartment'
        number:
          description: coach number
          type: string
        status:
          $ref: '#/components/schemas/AvailabilityStatus'
        layoutId:
          description: id to identify the coach layout
          type: string
        layoutIdUpperDeck:
          description: id to identify a layout for the upper deck in a double deck coach
          type: string
        layoutIdLowerDeck:
          description: id to identify a layout for the lower deck in a double deck coach
          type: string
        direction:
          description: >-
            indication of the direction of travel standard direction is left
            to right with ascending coordinates in the layout values.
          type: string
          x-extensible-enum:
            - UNSPECIFIED
            - IN_DIRECTION
            - OPPOSITE_DIRECTION
            - CHANGING
            - STARING_IN_DIRECTION
        owner:
          $ref: '#/components/schemas/Company'
        specialCoach:
          type: string
          description: indication of special coach 
          x-extensible-enum: 
            - RESTAURANT_COACH
            - BICYCLE_COACH
            - LUGGAGE_COACH
            - TRAIN_HEAD                
      required:
        - number
        - layoutId

    Compartment:
      description: >-
        Areas within a coach that holds places. Areas might be selectable
        as a whole. Usual areas would be classic compartments.
      type: object
      properties:
        places:
          type: array
          items:
            $ref: '#/components/schemas/PlacePosition'
        status:
          type: string
        isSelectable:
          description: to indicate compartments selectable as a whole only
          type: boolean
          default: false

    PlacePosition:
      description: description of a place
      type: object
      properties:
        number:
          description: >-
            the place number as indicated at the place in the coach
          type: string
        status:
          $ref: '#/components/schemas/AvailabilityStatus'
        isNotSelectable:
          description: >-
            Flag to indicate individual places as non-selectable in
            case complete compartments must be selected.
          type: boolean
          default: false
      required:
        - number
        - status

    AvailabilityStatus:
      description: status of the place or coach
      type: string
      enum:
        - ALLOCATED
        - FREE
        - RESTRICTED
      default: FREE

    SelectedCoach:
      type: object
      description: >-
        Place selection from a graphical display of coaches.
      properties:
        selectedCoaches:
          description: selected coach and places in case of graphical reservation
          type: array
          items:
            $ref: '#/components/schemas/SelectedPlaces'
      required:
        - selectedCoaches

    SelectedPlaces:
      type: object
      properties:
        coachNumber: 
          type: string
        selectedPlaces:
          description: selected places in case of graphical booking
          type: array
          items:           
            type: object
            properties:
              passengerId:
                description: >-
                  reference of the passenger.id
                type: string
                format: uuid
              place:
                type: string 

    Passenger:
      type: object
      description: >-
        Passenger information needed at offering step.
      properties:
        id: 
          type: string
          description: >-
            Id of the passenger resource in case service to patch a single passenger is provided.
          format: uuid
        abstract:
          type: string
          example: Andreas Schlapbach
        externalReference:
          description: >-
            stable reference to passengers from other elements, or from caller
            system.
          type: string
        dateOfBirth:
          description: date of birth of the passenger
          type: string
          format: date
        cards:
          description: reduction or loyalty cards owned by the passenger 
          type: array
          items:
            $ref: '#/components/schemas/CardReference'
        gender:
          $ref: '#/components/schemas/Gender'
        details:
          $ref: '#/components/schemas/PassengerDetail'
        passport:
          $ref: '#/components/schemas/IdentificationDocument'
        transportableDetails:
          $ref: '#/components/schemas/Transportable'          
        prmNeeds:
          type: array
          items:
            $ref: '#/components/schemas/PRMNeedType'
        links:
          type: array
          items:
            $ref: '#/components/schemas/Link'
      required:
        - abstract
        - links

    PRMNeedType:
      type: string
      x-extensible-enum:
        - NEED_PRM_SUPPORT
        - WHEELCHAIR
        - ACCOMPANYING_DOG
        - COMPANION_SEAT
        - COMPANION

    PassengerDetail:
      type: object
      description: >- 
        Passenger information potentially needed at booking step. The main purpose is
        being able to inform the customer of delays or disruptions.
        PassengerDetails providing personal information only information required in the booking.
        It is not allowed to send personal information not required in the booking reply.
        It is not allowed to send these personal data already in the booking request.
      properties:
        preferredLanguage:
          type: string
          description: Languages spoken by the traveler (ISO Language code)
        abstract:
          type: string
        firstName:
          type: string
        lastName:
          type: string
        eMail:
          type: string
        phoneNumber:
          description: Preferably a mobile phone number
          type: string
        address:
          description: address of the traveller. Can be relevant for some pass holders
          $ref: '#/components/schemas/Address'

    Gender:
      description: >- 
        The gender of the passenger, which is important in the case of night trains.
      type: string
      enum:
        - MALE
        - FEMALE
        - X

    Transportable:
      type: object
      description: >- 
        Transportables which are handled similar to passengers like dogs, bicycles, car transport.
        These transportables might need a ticket or reservation.
      properties:
        type:
          description: >- 
            Subset of the values from the traveler type code list IRS 90918-10 
          type: string
          x-extensible-enum:
            - PET
            - BICYCLE
            - CAR
            - MOTOR_CYCLE
            - CAR_TRAILER
        car:
          $ref: '#/components/schemas/Car'
        motorCycle:
          $ref: '#/components/schemas/MotorCycle'
        trailer:
          $ref: '#/components/schemas/Trailer'
      required:
        - type

    Car:
      type: object
      properties:
        weight:
          type: integer
          format: int32
        length:
          type: integer
          format: int32
        width:
          type: integer
          format: int32
        height:
          type: integer
          format: int32
        model:
          type: string
          description: Free text description of the model (e.g. BMW X5)       
        attachedItems:
          description: Indication of items attached to the car
          type: array
          items:
            type: string
            x-extensible-enum:
              - ROOF_RACK
              - BICYCLE_STAND
        plate:
          description: >-
            The trailer plate is a personal data item and must not be provided in an offer request. 
            It must be patched into the offer after the customer accepted the offer for booking.
          type: string
      required:
        - weight
        - length
        - width
        - height
        - model

    MotorCycle:    
      type: object
      properties:
        isSideCarIncluded:
          type: boolean
          default: false
        plate:
          description: >-
            The trailer plate is a personal data item and must not be provided in an offer request. 
            It must be patched into the offer after the customer accepted the offer for booking 
          type: string   
      required:
        - includingSideCar

    Trailer:
      type: object
      properties:
        weight:
          description: weight in kg
          type: integer
          format: int32
        length:
          description: length in cm
          type: integer
          format: int32
        width:
          description: width in cm
          type: integer
          format: int32
        height:
          description: length in cm
          type: integer
          format: int32
        plate:
          description: >-
            The trailer plate is a personal data item and must not be provided in an offer request. 
            It must be patched into the offer after the customer accepted the offer for booking 
          type: string
      required:
        - weight
        - length
        - width
        - height

    IdentificationDocument:
      type: object
      description: >- 
        Travel document data to be exchanged for border control in case of legal requirements
        PassengerDetails providing personal information only information required in the offer. 
        It is not allowed to send personal information not required in the offer reply. 
        It is legally not allowed to send these personal data already in the offer request.
      properties:
        id:
          description: Identifier on the document.
          type: string
        type:
          description: Refer to code list for values
          type: string
        name:
          description: ICAO transliteration identical as written in the document
          type: string
        nationality:
          description: ISO 3166 2A codes
          type: string
        cityOfBirth:
          type: string
        cityOfIssue:
          description: place where the document is issued
          type: string
        cityOfResidence:
          type: string
        countryOfBirth:
          description: ISO 3166 2A codes
          type: string
        countryOfIssue:
          description: ISO 3166 2A codes
          type: string
        countryOfResidence:
          description: ISO 3166 2A codes
          type: string
        dateOfIssue:
          type: string
          format: date-time
        gender:
          $ref: '#/components/schemas/Gender'
        limitOfValidity:
          type: string
          format: date-time
      required:
        - id
        - type

    CardReference:
      type: object
      properties:
        type:
          description: Types of card. One card can have multiple roles, such as loyalty and reduction
          type: array
          items:
            $ref: '#/components/schemas/CardType'

        code:
          description: Code of the card type according to code list.
          type: string
        codeList:
          description: Code list for the code provided.
          type: string
        name:
          description: Card name for printing on fulfillments.
          type: string
        number:
          description: Unique number identifying the card.
          type: string
        issuer:
          $ref: '#/components/schemas/Company'
      required:
        - type
        - codeList
        - code
     
    CardType:
      type: string
      enum:
        - REDUCTION
        - LOYALTY
        - CHIP_CARD
      default: REDUCTION

    #### Common elements end
